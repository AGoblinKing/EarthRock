var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function a(){return Object.create(null)}function r(t){t.forEach(n)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t,e,n){const a=e.subscribe(n);t.$$.on_destroy.push(a.unsubscribe?()=>a.unsubscribe():a)}function s(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function f(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function m(){return u(" ")}function g(){return u("")}function h(t,e,n,a){return t.addEventListener(e,n,a),()=>t.removeEventListener(e,n,a)}function p(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function v(t,e,n){t.style.setProperty(e,n)}function k(t,e,n){t.classList[n?"add":"remove"](e)}let x;function _(t){x=t}function b(t){(function(){if(!x)throw new Error("Function called outside component initialization");return x})().$$.on_mount.push(t)}const y=[],w=[],j=[],E=[],M=Promise.resolve();let T=!1;function S(t){j.push(t)}function C(){const t=new Set;do{for(;y.length;){const t=y.shift();_(t),I(t.$$)}for(;w.length;)w.pop()();for(let e=0;e<j.length;e+=1){const n=j[e];t.has(n)||(n(),t.add(n))}j.length=0}while(y.length);for(;E.length;)E.pop()();T=!1}function I(t){t.fragment&&(t.update(t.dirty),r(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(S))}const O=new Set;let R;function A(){R={remaining:0,callbacks:[]}}function L(){R.remaining||r(R.callbacks)}function N(t,e){t&&t.i&&(O.delete(t),t.i(e))}function P(t,e,n,a){if(t&&t.o){if(O.has(t))return;O.add(t),R.callbacks.push(()=>{O.delete(t),a&&(n&&t.d(1),a())}),t.o(e)}}function z(t,e){P(t,1,1,()=>{e.delete(t.key)})}function U(t,e){const n={},a={},r={$$scope:1};let o=t.length;for(;o--;){const c=t[o],i=e[o];if(i){for(const t in c)t in i||(a[t]=1);for(const t in i)r[t]||(n[t]=i[t],r[t]=1);t[o]=i}else for(const t in c)r[t]=1}for(const t in a)t in n||(n[t]=void 0);return n}function W(t,e,a){const{fragment:c,on_mount:i,on_destroy:s,after_update:d}=t.$$;c.m(e,a),S(()=>{const e=i.map(n).filter(o);s?s.push(...e):r(e),t.$$.on_mount=[]}),d.forEach(S)}function B(t,e){t.$$.fragment&&(r(t.$$.on_destroy),t.$$.fragment.d(e),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function D(t,e){t.$$.dirty||(y.push(t),T||(T=!0,M.then(C)),t.$$.dirty=a()),t.$$.dirty[e]=!0}function F(e,n,o,c,i,s){const d=x;_(e);const l=n.props||{},f=e.$$={fragment:null,ctx:null,props:s,update:t,not_equal:i,bound:a(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:a(),dirty:null};let u=!1;var m;f.ctx=o?o(e,l,(t,n)=>{f.ctx&&i(f.ctx[t],f.ctx[t]=n)&&(f.bound[t]&&f.bound[t](n),u&&D(e,t))}):l,f.update(),u=!0,r(f.before_update),f.fragment=c(f.ctx),n.target&&(n.hydrate?f.fragment.l((m=n.target,Array.from(m.childNodes))):f.fragment.c(),n.intro&&N(e.$$.fragment),W(e,n.target,n.anchor),C()),_(d)}class H{$destroy(){B(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function K(e){var n;return{c(){p(n=f("img"),"class","tileset svelte-1bdmb53"),p(n,"alt","tileset image")},m(t,a){d(t,n,a),e.img_binding(n)},p:t,i:t,o:t,d(t){t&&l(n),e.img_binding(null)}}}const q=16,G=1,J=32,X=1024;function Y(t,e,n){const a=new Map,r=new Promise(t=>{const e=new Image;e.src="/sheets/default.png",e.onload=(()=>{const n=document.createElement("canvas");n.width=e.width,n.height=e.height;const a=n.getContext("2d");a.drawImage(e,0,0),t({ctx:a,canvas:n})})});let o,{data:c="",width:i=10,height:s=7,spacing:d=0,random:l=!1}=e;const f=(t,e)=>Math.floor(Math.random()*(Math.abs(t)+Math.abs(e))-Math.abs(t));let u;return b(async()=>{const{canvas:t}=await r;if(a.has(u))return o.src=a.get(u),void n("image",o);let e=document.createElement("canvas");const d=e.getContext("2d");if(e.width=q*i,e.height=q*s,l)((t,e)=>{let n,a,r,o;for(let c=0;c<i;c++)for(let i=0;i<s;i++)n=c*q,a=i*q,r=f(0,J)*(q+G),o=f(0,X/J)*(q+G),t.drawImage(e,r,o,q,q,n,a,q,q)})(d,t);else if(c.length>0){let e,n;c.split(" ").forEach((a,r)=>{e=r%i,n=Math.floor(r/i);let o=parseInt(a,10),c=o%J,s=Math.floor(o/J),l=e*q,f=n*q,u=c*(q+G),m=s*(q+G);d.drawImage(t,u,m,q,q,l,f,q,q)})}o.src=e.toDataURL("image/png"),n("image",o),a.set(KeyboardEvent,o.src)}),t.$set=(t=>{"data"in t&&n("data",c=t.data),"width"in t&&n("width",i=t.width),"height"in t&&n("height",s=t.height),"spacing"in t&&n("spacing",d=t.spacing),"random"in t&&n("random",l=t.random)}),t.$$.update=((t={width:1,height:1,data:1})=>{(t.width||t.height||t.data)&&(u=`${i}:${s}:${c}`)}),{data:c,width:i,height:s,spacing:d,random:l,image:o,img_binding:function(t){w[t?"unshift":"push"](()=>{n("image",o=t)})}}}class Q extends H{constructor(t){super(),F(this,t,Y,K,c,["data","width","height","spacing","random"])}}function V(e){var n,a,r,o,c,i,s,u,g,$,v,k=new Q({props:{random:!0}});return{c(){n=f("div"),k.$$.fragment.c(),a=m(),(r=f("h1")).textContent="EarthRock",o=m(),(c=f("h2")).textContent="The Uncollectable Card Game",i=m(),(s=f("button")).textContent="START",u=m(),(g=f("div")).textContent="We don't use cookies or store anything about you server side.",p(n,"class","background svelte-1ks0xde"),p(r,"class","title svelte-1ks0xde"),p(c,"class","desc svelte-1ks0xde"),p(s,"class","svelte-1ks0xde"),p(g,"class","notice svelte-1ks0xde"),v=h(s,"click",e.clicked)},m(t,e){d(t,n,e),W(k,n,null),d(t,a,e),d(t,r,e),d(t,o,e),d(t,c,e),d(t,i,e),d(t,s,e),d(t,u,e),d(t,g,e),$=!0},p:t,i(t){$||(N(k.$$.fragment,t),$=!0)},o(t){P(k.$$.fragment,t),$=!1},d(t){t&&l(n),B(k),t&&(l(a),l(r),l(o),l(c),l(i),l(s),l(u),l(g)),v()}}}function Z(t){return{clicked:()=>{alert("Woah there speedy aint got nothing more yet")}}}class tt extends H{constructor(t){super(),F(this,t,Z,V,c,[])}}function et(e,n=t){let a;const r=[];function o(t){if(c(e,t)){if(e=t,!a)return;r.forEach(t=>t[1]()),r.forEach(t=>t[0](e))}}return{set:o,update:function(t){o(t(e))},subscribe:function(c,i=t){const s=[c,i];return r.push(s),1===r.length&&(a=n(o)||t),c(e),()=>{const t=r.indexOf(s);-1!==t&&r.splice(t,1),0===r.length&&(a(),a=null)}}}}const nt=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}),at=t=>{const e=[];for(let n=0;n<t;n++)e.push(Math.floor(1024*Math.random()));return e.join(" ")},rt=()=>({id:nt(),name:at(5),image:at(100),cost:Math.floor(10*Math.random()),effect1:at(3),effect2:at(3),effect3:at(3)}),ot=t=>{const e=[];for(let n=0;n<t;n++)e.push(rt());return e},ct={faked:!1,tasks:{STATE:new Set},state:{away_deck:et([]),away_hand:et([]),away_discard:et([]),away_field:et([]),away_back:et(""),home_deck:et([]),home_hand:et([]),home_discard:et([]),home_field:et([]),home_back:et("")},server_fake:()=>{ct.faked=(t=>{const e={ERROR_404:()=>({code:404,text:"TaSk NoT FoUnD"})};return t.do({task:"STATE",data:{away_deck:ot(30),home_deck:ot(30),away_hand:ot(7),home_hand:ot(7),away_back:at(15),home_back:at(15)}}),({task:t,data:n})=>e[t]?e[t](n):e.ERROR_404()})(ct)},do:({task:t,data:e})=>{void 0!==ct.tasks[t]?ct.tasks[t].forEach(t=>t(e)):console.error(`Tried to call an undefined task ${t}`)},do_server:async t=>{if(ct.faked)return ct.faked(t);return(await fetch("/do",{method:"POST",mode:"same-origin",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()},when:(t,e)=>{if(void 0!==ct.tasks[t])return ct.tasks[t].add(e),()=>{ct.tasks[t].delete(e)};console.error(`Tried to wait for an undefined task ${t}`)}};function it(t,e,n){const a=Object.create(t);return a.line=e[n],a}function st(t){var e,n,a,r,o,c,i;return{c(){e=f("div"),n=m(),a=f("div"),r=m(),o=f("div"),c=m(),i=f("div"),p(e,"class","border border-top svelte-jimjmx"),p(a,"class","border border-bottom svelte-jimjmx"),p(o,"class","border border-left svelte-jimjmx"),p(i,"class","border border-right svelte-jimjmx")},m(t,s){d(t,e,s),d(t,n,s),d(t,a,s),d(t,r,s),d(t,o,s),d(t,c,s),d(t,i,s)},d(t){t&&(l(e),l(n),l(a),l(r),l(o),l(c),l(i))}}}function dt(t){var e,n,a,r,o,c,i,g,h,v,k,x,_,b=t.vitals[0],y=t.vitals[1],w=new Q({props:{width:1,height:1,random:!0}}),j=new Q({props:{width:1,height:1,random:!0}}),E=new Q({props:{width:1,height:1,random:!0}});return{c(){e=f("div"),n=f("div"),a=f("div"),w.$$.fragment.c(),r=m(),o=f("div"),c=f("div"),j.$$.fragment.c(),i=m(),g=u(b),h=m(),v=f("div"),E.$$.fragment.c(),k=m(),x=u(y),p(a,"class","tile svelte-jimjmx"),p(n,"class","icon svelte-jimjmx"),p(c,"class","tile svelte-jimjmx"),p(v,"class","tile svelte-jimjmx"),p(o,"class","vitals svelte-jimjmx"),p(e,"class","line svelte-jimjmx")},m(t,l){d(t,e,l),s(e,n),s(n,a),W(w,a,null),s(e,r),s(e,o),s(o,c),W(j,c,null),s(o,i),s(o,g),s(o,h),s(o,v),W(E,v,null),s(o,k),s(o,x),_=!0},p(t,e){_&&!t.vitals||b===(b=e.vitals[0])||$(g,b),_&&!t.vitals||y===(y=e.vitals[1])||$(x,y)},i(t){_||(N(w.$$.fragment,t),N(j.$$.fragment,t),N(E.$$.fragment,t),_=!0)},o(t){P(w.$$.fragment,t),P(j.$$.fragment,t),P(E.$$.fragment,t),_=!1},d(t){t&&l(e),B(w),B(j),B(E)}}}function lt(t){for(var e,n,a,o,c,i,g,x,_,b,y,w,j,E,M,T,S,C,I,O,R,z,U,D=t.borders&&st(),F=new Q({props:{width:3,height:5,data:t.back}}),H=new Q({props:{data:t.name,width:5,height:1}}),K=new Q({props:{width:10,height:10,data:t.image}}),q=t.lines,G=[],J=0;J<q.length;J+=1)G[J]=dt(it(t,q,J));const X=t=>P(G[t],1,1,()=>{G[t]=null});return{c(){e=f("div"),n=f("div"),D&&D.c(),a=m(),o=f("div"),F.$$.fragment.c(),c=m(),i=f("div"),g=f("div"),x=f("div"),H.$$.fragment.c(),_=m(),b=f("div"),y=m(),w=f("div"),j=u(t.cost),E=m(),M=f("div"),K.$$.fragment.c(),T=m(),S=f("div");for(var r=0;r<G.length;r+=1)G[r].c();C=m(),I=f("div"),O=m(),(R=f("div")).textContent="E A R T H R O C K",p(o,"class","back svelte-jimjmx"),v(o,"filter","sepia(1) hue-rotate("+t.color+"deg)"),p(x,"class","title svelte-jimjmx"),p(b,"class","flex svelte-jimjmx"),p(w,"class","cost svelte-jimjmx"),p(g,"class","header svelte-jimjmx"),p(M,"class","image svelte-jimjmx"),p(I,"class","flex svelte-jimjmx"),p(S,"class","details svelte-jimjmx"),p(R,"class","earthrock svelte-jimjmx"),p(i,"class","front svelte-jimjmx"),p(n,"class","contents svelte-jimjmx"),k(n,"flip",t.flip),p(e,"style",t.style),p(e,"class","card svelte-jimjmx"),k(e,"dragging",t.dragging),U=[h(o,"click",t.beginInteract),h(i,"mousedown",t.beginInteract),h(i,"mouseup",t.stopInteract),h(e,"mouseenter",t.delay_hover.on),h(e,"mouseleave",t.delay_hover.off)]},m(t,r){d(t,e,r),s(e,n),D&&D.m(n,null),s(n,a),s(n,o),W(F,o,null),s(n,c),s(n,i),s(i,g),s(g,x),W(H,x,null),s(g,_),s(g,b),s(g,y),s(g,w),s(w,j),s(i,E),s(i,M),W(K,M,null),s(i,T),s(i,S);for(var l=0;l<G.length;l+=1)G[l].m(S,null);s(S,C),s(S,I),s(i,O),s(i,R),z=!0},p(t,r){r.borders?D||((D=st()).c(),D.m(n,a)):D&&(D.d(1),D=null);var c={};t.back&&(c.data=r.back),F.$set(c),z&&!t.color||v(o,"filter","sepia(1) hue-rotate("+r.color+"deg)");var i={};t.name&&(i.data=r.name),H.$set(i),z&&!t.cost||$(j,r.cost);var s={};if(t.image&&(s.data=r.image),K.$set(s),t.vitals||t.lines){q=r.lines;for(var d=0;d<q.length;d+=1){const e=it(r,q,d);G[d]?(G[d].p(t,e),N(G[d],1)):(G[d]=dt(e),G[d].c(),N(G[d],1),G[d].m(S,C))}for(A(),d=q.length;d<G.length;d+=1)X(d);L()}t.flip&&k(n,"flip",r.flip),z&&!t.style||p(e,"style",r.style),t.dragging&&k(e,"dragging",r.dragging)},i(t){if(!z){N(F.$$.fragment,t),N(H.$$.fragment,t),N(K.$$.fragment,t);for(var e=0;e<q.length;e+=1)N(G[e]);z=!0}},o(t){P(F.$$.fragment,t),P(H.$$.fragment,t),P(K.$$.fragment,t),G=G.filter(Boolean);for(let t=0;t<G.length;t+=1)P(G[t]);z=!1},d(t){t&&l(e),D&&D.d(),B(F),B(H),B(K),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(G,t),r(U)}}}ct.when("STATE",t=>Object.entries(t).forEach(([t,e])=>ct.state[t].set(e)));const ft=.5;function ut(t,e,n){let a,{deck:r="",id:o="foobar",cost:c=0,name:s="16 55 33 44 55",image:d="",effect1:l="",effect2:f="",effect3:u="",back:m="",borders:g=!0,vitals:h=[1,1],invert:p=!1,interact:$=!0,drag:v=!1,position:k=[0,0],rotation:x=0,scale:_=1,color:y=90,card:w={},onclick:j=(()=>{})}=e,{young:E=!0}=e;const M=[l,f,u],T=et([0,0]);i(t,T,t=>{n("$mouse_pos",a=t)});const S=[0,0];window.addEventListener("mousemove",t=>{S[0]=t.clientX,S[1]=t.clientY}),setInterval(()=>{S[0]===a[0]&&S[1]===a[1]||T.set([...S])},50);let C=!0;b(()=>{setTimeout(()=>{n("young",E=!1),n("flip",C=!$)},1e3)});let I=!1;const O=(({time:t=250,on:e=(()=>{}),off:n=(()=>{})})=>{let a;return{on:()=>{$&&(a&&clearTimeout(a),e())},off:()=>{$&&(a&&clearTimeout(a),a=setTimeout(()=>{a=0,n()},t))}}})({time:100,on:()=>{n("hover",L=!0)},off:()=>{const t=L=!1;return n("hover",L),t}});let R,A,L=!1;return t.$set=(t=>{"deck"in t&&n("deck",r=t.deck),"id"in t&&n("id",o=t.id),"cost"in t&&n("cost",c=t.cost),"name"in t&&n("name",s=t.name),"image"in t&&n("image",d=t.image),"effect1"in t&&n("effect1",l=t.effect1),"effect2"in t&&n("effect2",f=t.effect2),"effect3"in t&&n("effect3",u=t.effect3),"back"in t&&n("back",m=t.back),"borders"in t&&n("borders",g=t.borders),"vitals"in t&&n("vitals",h=t.vitals),"invert"in t&&n("invert",p=t.invert),"interact"in t&&n("interact",$=t.interact),"drag"in t&&n("drag",v=t.drag),"position"in t&&n("position",k=t.position),"rotation"in t&&n("rotation",x=t.rotation),"scale"in t&&n("scale",_=t.scale),"color"in t&&n("color",y=t.color),"card"in t&&n("card",w=t.card),"onclick"in t&&n("onclick",j=t.onclick),"young"in t&&n("young",E=t.young)}),t.$$.update=((t={hover:1,scale:1,dragging:1,$mouse_pos:1,position:1,invert:1,rotation:1,tru_scale:1})=>{(t.hover||t.scale)&&n("tru_scale",R=L?1.168*_:_),(t.dragging||t.$mouse_pos||t.position||t.hover||t.invert||t.rotation||t.tru_scale)&&n("style",A=I?`transform: translate(${a[0]-window.innerWidth/2-250}px, ${a[1]-window.innerHeight/2-400}px) rotate(0deg) scale(${ft});z-index: 100`:`transform: translate(${-50+k[0]}%, ${-50+k[1]+(L?p?5:-5:0)}%) rotate(${x}deg) scale(${R}) ; z-index: ${Math.round(100*R)}`)}),{deck:r,id:o,cost:c,name:s,image:d,effect1:l,effect2:f,effect3:u,back:m,borders:g,vitals:h,invert:p,interact:$,drag:v,position:k,rotation:x,scale:_,color:y,card:w,onclick:j,young:E,lines:M,mouse_pos:T,flip:C,dragging:I,beginInteract:()=>{if(j(),v){n("dragging",I=!0);const t=window.addEventListener("mouseup",()=>{n("dragging",I=!1),window.removeEventListener("mouseup",t)})}},stopInteract:()=>{n("dragging",I=!1)},delay_hover:O,style:A}}class mt extends H{constructor(t){super(),F(this,t,ut,lt,c,["deck","id","cost","name","image","effect1","effect2","effect3","back","borders","vitals","invert","interact","drag","position","rotation","scale","color","card","onclick","young"])}}function gt(t,e,n){const a=Object.create(t);return a.card=e[n],a.index=n,a}function ht(t){var n,a=[t.card,{scale:t.scale},{invert:t.invert},{interact:t.interact},{color:t.color},{onclick:t.onclick},{card:t.card},{drag:t.drag},{back:t.$back},{position:[t.index*t.tru_spread*t.scale-t.tru_length/2*t.tru_spread*t.scale+t.position[0],t.position[1]+(t.invert?-1:1)*Math.abs(t.index-t.tru_length/2)*t.spread_y]},{rotation:(t.index-t.tru_length/2)*t.tru_rotate*(t.invert?-1:1)+(t.invert?180:0)}];let r={};for(var o=0;o<a.length;o+=1)r=e(r,a[o]);var c=new mt({props:r});return{c(){c.$$.fragment.c()},m(t,e){W(c,t,e),n=!0},p(t,e){var n=t.$cards||t.scale||t.invert||t.interact||t.color||t.onclick||t.drag||t.$back||t.tru_spread||t.tru_length||t.position||t.spread_y||t.tru_rotate?U(a,[t.$cards&&e.card,t.scale&&{scale:e.scale},t.invert&&{invert:e.invert},t.interact&&{interact:e.interact},t.color&&{color:e.color},t.onclick&&{onclick:e.onclick},t.$cards&&{card:e.card},t.drag&&{drag:e.drag},t.$back&&{back:e.$back},(t.$cards||t.tru_spread||t.scale||t.tru_length||t.position||t.invert||t.spread_y)&&{position:[e.index*e.tru_spread*e.scale-e.tru_length/2*e.tru_spread*e.scale+e.position[0],e.position[1]+(e.invert?-1:1)*Math.abs(e.index-e.tru_length/2)*e.spread_y]},(t.$cards||t.tru_length||t.tru_rotate||t.invert)&&{rotation:(e.index-e.tru_length/2)*e.tru_rotate*(e.invert?-1:1)+(e.invert?180:0)}]):{};c.$set(n)},i(t){n||(N(c.$$.fragment,t),n=!0)},o(t){P(c.$$.fragment,t),n=!1},d(t){B(c,t)}}}function pt(t,e){var n,a,r,o=e.index<e.max&&ht(e);return{key:t,first:null,c(){n=g(),o&&o.c(),a=g(),this.first=n},m(t,e){d(t,n,e),o&&o.m(t,e),d(t,a,e),r=!0},p(t,e){e.index<e.max?o?(o.p(t,e),N(o,1)):((o=ht(e)).c(),N(o,1),o.m(a.parentNode,a)):o&&(A(),P(o,1,1,()=>{o=null}),L())},i(t){r||(N(o),r=!0)},o(t){P(o),r=!1},d(t){t&&l(n),o&&o.d(t),t&&l(a)}}}function $t(t){var e,n,a=[],r=new Map,o=t.$cards;const c=t=>t.card.id;for(var i=0;i<o.length;i+=1){let e=gt(t,o,i),n=c(e);r.set(n,a[i]=pt(n,e))}return{c(){for(i=0;i<a.length;i+=1)a[i].c();e=g()},m(t,r){for(i=0;i<a.length;i+=1)a[i].m(t,r);d(t,e,r),n=!0},p(t,n){const o=n.$cards;A(),a=function(t,e,n,a,r,o,c,i,s,d,l,f){let u=t.length,m=o.length,g=u;const h={};for(;g--;)h[t[g].key]=g;const p=[],$=new Map,v=new Map;for(g=m;g--;){const t=f(r,o,g),i=n(t);let s=c.get(i);s?a&&s.p(e,t):(s=d(i,t)).c(),$.set(i,p[g]=s),i in h&&v.set(i,Math.abs(g-h[i]))}const k=new Set,x=new Set;function _(t){N(t,1),t.m(i,l),c.set(t.key,t),l=t.first,m--}for(;u&&m;){const e=p[m-1],n=t[u-1],a=e.key,r=n.key;e===n?(l=e.first,u--,m--):$.has(r)?!c.has(a)||k.has(a)?_(e):x.has(r)?u--:v.get(a)>v.get(r)?(x.add(a),_(e)):(k.add(r),u--):(s(n,c),u--)}for(;u--;){const e=t[u];$.has(e.key)||s(e,c)}for(;m;)_(p[m-1]);return p}(a,t,c,1,n,o,r,e.parentNode,z,pt,e,gt),L()},i(t){if(!n){for(var e=0;e<o.length;e+=1)N(a[e]);n=!0}},o(t){for(i=0;i<a.length;i+=1)P(a[i]);n=!1},d(t){for(i=0;i<a.length;i+=1)a[i].d(t);t&&l(e)}}}function vt(t,e,n){let a,r,{cards:o=et([]),max:c=10,position:s=[0,0],invert:d=!1,scale:l=1,drag:f=!1,spread:u=16.18,spread_y:m=2,interact:g=!0,count_factor:h=30,rotate:p=16.18,color:$=90,onclick:v=(()=>{})}=e;i(t,o,t=>{n("$cards",a=t)});let k,x,_,b,{back:y=et("")}=e;return i(t,y,t=>{n("$back",r=t)}),t.$set=(t=>{"cards"in t&&n("cards",o=t.cards),"max"in t&&n("max",c=t.max),"position"in t&&n("position",s=t.position),"invert"in t&&n("invert",d=t.invert),"scale"in t&&n("scale",l=t.scale),"drag"in t&&n("drag",f=t.drag),"spread"in t&&n("spread",u=t.spread),"spread_y"in t&&n("spread_y",m=t.spread_y),"interact"in t&&n("interact",g=t.interact),"count_factor"in t&&n("count_factor",h=t.count_factor),"rotate"in t&&n("rotate",p=t.rotate),"color"in t&&n("color",$=t.color),"onclick"in t&&n("onclick",v=t.onclick),"back"in t&&n("back",y=t.back)}),t.$$.update=((t={$cards:1,max:1,count_factor:1,spread:1,x_factor:1,rotate:1})=>{(t.$cards||t.max)&&n("tru_length",k=a.length>c?c:a.length),(t.$cards||t.count_factor)&&n("x_factor",x=a.length/h),(t.spread||t.x_factor)&&n("tru_spread",_=u/x),(t.rotate||t.x_factor)&&n("tru_rotate",b=p*x)}),{cards:o,max:c,position:s,invert:d,scale:l,drag:f,spread:u,spread_y:m,interact:g,count_factor:h,rotate:p,color:$,onclick:v,back:y,tru_length:k,$cards:a,tru_spread:_,tru_rotate:b,$back:r}}class kt extends H{constructor(t){super(),F(this,t,vt,$t,c,["cards","max","position","invert","scale","drag","spread","spread_y","interact","count_factor","rotate","color","onclick","back"])}}function xt(t){var n,a,r,o,c=new kt({props:{cards:ct.state.home_hand,scale:_t,position:[0,40],back:ct.state.home_back,drag:!0}}),i=new kt({props:{cards:ct.state.away_hand,scale:_t,position:[0,-40],interact:!1,color:180,invert:!0,back:ct.state.away_back}}),s=[t.deck,{cards:ct.state.home_deck},{position:[90,40]},{back:ct.state.home_back}];let f={};for(var u=0;u<s.length;u+=1)f=e(f,s[u]);var g=new kt({props:f}),h=[{invert:!0},t.deck,{cards:ct.state.away_deck},{color:180},{position:[90,-40]},{back:ct.state.away_back}];let p={};for(u=0;u<h.length;u+=1)p=e(p,h[u]);var $=new kt({props:p});return{c(){c.$$.fragment.c(),n=m(),i.$$.fragment.c(),a=m(),g.$$.fragment.c(),r=m(),$.$$.fragment.c()},m(t,e){W(c,t,e),d(t,n,e),W(i,t,e),d(t,a,e),W(g,t,e),d(t,r,e),W($,t,e),o=!0},p(t,e){var n={};t.game&&(n.cards=ct.state.home_hand),t.scale&&(n.scale=_t),t.game&&(n.back=ct.state.home_back),c.$set(n);var a={};t.game&&(a.cards=ct.state.away_hand),t.scale&&(a.scale=_t),t.game&&(a.back=ct.state.away_back),i.$set(a);var r=t.deck||t.game?U(s,[t.deck&&e.deck,t.game&&{cards:ct.state.home_deck},{position:[90,40]},t.game&&{back:ct.state.home_back}]):{};g.$set(r);var o=t.deck||t.game?U(h,[{invert:!0},t.deck&&e.deck,t.game&&{cards:ct.state.away_deck},{color:180},{position:[90,-40]},t.game&&{back:ct.state.away_back}]):{};$.$set(o)},i(t){o||(N(c.$$.fragment,t),N(i.$$.fragment,t),N(g.$$.fragment,t),N($.$$.fragment,t),o=!0)},o(t){P(c.$$.fragment,t),P(i.$$.fragment,t),P(g.$$.fragment,t),P($.$$.fragment,t),o=!1},d(t){B(c,t),t&&l(n),B(i,t),t&&l(a),B(g,t),t&&l(r),B($,t)}}}const _t=.25;function bt(t){const e={scale:_t,spread:0,max:4,count_factor:250,interact:!1};return ct.server_fake(),{deck:e}}class yt extends H{constructor(t){super(),F(this,t,bt,xt,c,[])}}function wt(e){var n,a,r,o=e.playing?"🕪":"🕨";return{c(){n=f("div"),a=u(o),p(n,"class","sound svelte-niubn2"),r=h(n,"click",e.toggle)},m(t,e){d(t,n,e),s(n,a)},p(t,e){t.playing&&o!==(o=e.playing?"🕪":"🕨")&&$(a,o)},i:t,o:t,d(t){t&&l(n),r()}}}function jt(t,e,n){const a=new Audio("/music/earthrock-final-theme.mp3");a.loop=!0,a.volume=.5;let r=!1;return{playing:r,toggle:()=>{r?a.pause():a.play(),n("playing",r=!r)}}}class Et extends H{constructor(t){super(),F(this,t,jt,wt,c,[])}}function Mt(e){var n,a,r,o=new tt({}),c=new Et({}),i=new yt({});return{c(){o.$$.fragment.c(),n=m(),c.$$.fragment.c(),a=m(),i.$$.fragment.c()},m(t,e){W(o,t,e),d(t,n,e),W(c,t,e),d(t,a,e),W(i,t,e),r=!0},p:t,i(t){r||(N(o.$$.fragment,t),N(c.$$.fragment,t),N(i.$$.fragment,t),r=!0)},o(t){P(o.$$.fragment,t),P(c.$$.fragment,t),P(i.$$.fragment,t),r=!1},d(t){B(o,t),t&&l(n),B(c,t),t&&l(a),B(i,t)}}}return new class extends H{constructor(t){super(),F(this,t,null,Mt,c,[])}}({target:document.body,props:{name:"stage"}})}();

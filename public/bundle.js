var app=function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function a(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(a)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e,n){const a=e.subscribe(n);t.$$.on_destroy.push(a.unsubscribe?()=>a.unsubscribe():a)}function l(t,e,a){return t[1]?n({},n(e.$$scope.ctx,t[1](a?a(e):{}))):e.$$scope.ctx}let d="undefined"!=typeof window?()=>window.performance.now():()=>Date.now(),h=t=>requestAnimationFrame(t);const g=new Set;let u,f=!1;function $(){g.forEach(t=>{t[0](d())||(g.delete(t),t[1]())}),(f=g.size>0)&&h($)}function m(t){let e;return f||(f=!0,h($)),{promise:new Promise(n=>{g.add(e=[t,n])}),abort(){g.delete(e)}}}function p(t,e){t.appendChild(e)}function _(t,e,n){t.insertBefore(e,n||null)}function v(t){t.parentNode.removeChild(t)}function k(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function y(t){return document.createElement(t)}function b(t){return document.createTextNode(t)}function w(){return b(" ")}function x(){return b("")}function M(t,e,n,a){return t.addEventListener(e,n,a),()=>t.removeEventListener(e,n,a)}function E(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function S(t,e){e=""+e,t.data!==e&&(t.data=e)}function C(t,e,n){t.style.setProperty(e,n)}function I(t,e,n){t.classList[n?"add":"remove"](e)}function T(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}let z,A=0,R={};function j(t,e){t.style.animation=(t.style.animation||"").split(", ").filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")).join(", "),e&&!--A&&h(()=>{if(A)return;let t=u.cssRules.length;for(;t--;)u.deleteRule(t);R={}})}function O(t){z=t}function q(t){(function(){if(!z)throw new Error("Function called outside component initialization");return z})().$$.on_mount.push(t)}function L(){const t=z;return(e,n)=>{const a=t.$$.callbacks[e];if(a){const r=T(e,n);a.slice().forEach(e=>{e.call(t,r)})}}}const N=[],P=[],D=[],U=[],W=Promise.resolve();let B,H=!1;function F(t){D.push(t)}function K(){const t=new Set;do{for(;N.length;){const t=N.shift();O(t),Y(t.$$)}for(;P.length;)P.pop()();for(let e=0;e<D.length;e+=1){const n=D[e];t.has(n)||(n(),t.add(n))}D.length=0}while(N.length);for(;U.length;)U.pop()();H=!1}function Y(t){t.fragment&&(t.update(t.dirty),o(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(F))}function G(t,e,n){t.dispatchEvent(T(`${e?"intro":"outro"}${n}`))}const X=new Set;let J;function Q(){J={remaining:0,callbacks:[]}}function V(){J.remaining||o(J.callbacks)}function Z(t,e){t&&t.i&&(X.delete(t),t.i(e))}function tt(t,e,n,a){if(t&&t.o){if(X.has(t))return;X.add(t),J.callbacks.push(()=>{X.delete(t),a&&(n&&t.d(1),a())}),t.o(e)}}function et(n,a,r){let s,c=a(n,r),l=!0;const h=J;function g(){const{delay:a=0,duration:r=300,easing:i=e,tick:g=t,css:f}=c;f&&(s=function(t,e,n,a,r,o,i,s=0){const c=16.666/a;let l="{\n";for(let t=0;t<=1;t+=c){const a=e+(n-e)*o(t);l+=100*t+`%{${i(a,1-a)}}\n`}const d=l+`100% {${i(n,1-n)}}\n}`,h=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(d)}_${s}`;if(!R[h]){if(!u){const t=y("style");document.head.appendChild(t),u=t.sheet}R[h]=!0,u.insertRule(`@keyframes ${h} ${d}`,u.cssRules.length)}const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${h} ${a}ms linear ${r}ms 1 both`,A+=1,h}(n,1,0,r,a,i,f));const $=d()+a,p=$+r;F(()=>G(n,!1,"start")),m(t=>{if(l){if(t>=p)return g(0,1),G(n,!1,"end"),--h.remaining||o(h.callbacks),!1;if(t>=$){const e=i((t-$)/r);g(1-e,e)}}return l})}return h.remaining+=1,i(c)?(B||(B=Promise.resolve()).then(()=>{B=null}),B).then(()=>{c=c(),g()}):g(),{end(t){t&&c.tick&&c.tick(1,0),l&&(s&&j(n,s),l=!1)}}}function nt(t,e){tt(t,1,1,()=>{e.delete(t.key)})}function at(t,e){const n={},a={},r={$$scope:1};let o=t.length;for(;o--;){const i=t[o],s=e[o];if(s){for(const t in i)t in s||(a[t]=1);for(const t in s)r[t]||(n[t]=s[t],r[t]=1);t[o]=s}else for(const t in i)r[t]=1}for(const t in a)t in n||(n[t]=void 0);return n}function rt(t){let e;const n=t.subscribe(t=>e=t);return n.unsubscribe?n.unsubscribe():n(),e}function ot(t,e,n){const{fragment:r,on_mount:s,on_destroy:c,after_update:l}=t.$$;r.m(e,n),F(()=>{const e=s.map(a).filter(i);c?c.push(...e):o(e),t.$$.on_mount=[]}),l.forEach(F)}function it(t,e){t.$$.fragment&&(o(t.$$.on_destroy),t.$$.fragment.d(e),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function st(t,e){t.$$.dirty||(N.push(t),H||(H=!0,W.then(K)),t.$$.dirty=r()),t.$$.dirty[e]=!0}function ct(e,n,a,i,s,c){const l=z;O(e);const d=n.props||{},h=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:s,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:r(),dirty:null};let g=!1;var u;h.ctx=a?a(e,d,(t,n)=>{h.ctx&&s(h.ctx[t],h.ctx[t]=n)&&(h.bound[t]&&h.bound[t](n),g&&st(e,t))}):d,h.update(),g=!0,o(h.before_update),h.fragment=i(h.ctx),n.target&&(n.hydrate?h.fragment.l((u=n.target,Array.from(u.childNodes))):h.fragment.c(),n.intro&&Z(e.$$.fragment),ot(e,n.target,n.anchor),K()),O(l)}class lt{$destroy(){it(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function dt(t){const e=t-1;return e*e*e+1}function ht(t,{delay:e=0,duration:n=400}){const a=+getComputedStyle(t).opacity;return{delay:e,duration:n,css:t=>`opacity: ${t*a}`}}function gt(t,{delay:e=0,duration:n=400,easing:a=dt,x:r=0,y:o=0,opacity:i=0}){const s=getComputedStyle(t),c=+s.opacity,l="none"===s.transform?"":s.transform,d=c*(1-i);return{delay:e,duration:n,easing:a,css:(t,e)=>`\n\t\t\ttransform: ${l} translate(${(1-t)*r}px, ${(1-t)*o}px);\n\t\t\topacity: ${c-d*e}`}}function ut(n){var a,r,i,s,c,l,d,h,g,u,f,$,m,k,b,x;return{c(){a=y("div"),(r=y("h1")).textContent="EarthRock",i=w(),(s=y("h2")).textContent="The Uncollectable Card Game",c=w(),l=y("div"),(d=y("button")).textContent="START",h=w(),(g=y("button")).textContent="DESIGN",u=w(),(f=y("button")).textContent="DISCORD",$=w(),(m=y("div")).textContent="We don't use cookies or store anything about you server side.",E(r,"class","title svelte-1ag79qm"),E(s,"class","desc svelte-1ag79qm"),E(d,"class","svelte-1ag79qm"),E(g,"class","svelte-1ag79qm"),E(f,"class","svelte-1ag79qm"),E(l,"class","menu svelte-1ag79qm"),E(m,"class","notice svelte-1ag79qm"),E(a,"class","intro svelte-1ag79qm"),x=[M(d,"click",n.click_handler),M(g,"click",n.click_handler_1),M(f,"click",ft)]},m(t,e){_(t,a,e),p(a,r),p(a,i),p(a,s),p(a,c),p(a,l),p(l,d),p(l,h),p(l,g),p(l,u),p(l,f),p(a,$),p(a,m),b=!0},p:t,i(t){b||(k&&k.end(1),b=!0)},o(t){k=et(a,gt,{delay:100,duration:1e3,x:0,y:4e3,opacity:0,easing:e}),b=!1},d(t){t&&(v(a),k&&k.end()),o(x)}}}function ft(){return window.open("https://discord.gg/HnvRaKS","_blank")}function $t(t){const e=L();return{dispatch:e,click_handler:function(){return e("start")},click_handler_1:function(){return e("design")}}}class mt extends lt{constructor(t){super(),ct(this,t,$t,ut,s,[])}}window.location.host;function pt(t){var e,n;return{c(){(e=y("div")).textContent="X",E(e,"class","svelte-1uluz44"),n=M(e,"click",t.click_handler)},m(t,n){_(t,e,n)},d(t){t&&v(e),n()}}}function _t(e){var n,a,r,o,i,s=e.audo_playing?"<>":">",c=(e.playing||e.designing)&&pt(e);return{c(){n=y("div"),a=y("div"),r=b(s),o=w(),c&&c.c(),E(a,"class","svelte-1uluz44"),E(n,"class","tools svelte-1uluz44"),i=M(a,"click",e.toggle)},m(t,e){_(t,n,e),p(n,a),p(a,r),p(n,o),c&&c.m(n,null)},p(t,e){t.audo_playing&&s!==(s=e.audo_playing?"<>":">")&&S(r,s),e.playing||e.designing?c||((c=pt(e)).c(),c.m(n,null)):c&&(c.d(1),c=null)},i:t,o:t,d(t){t&&v(n),c&&c.d(),i()}}}function vt(t,e,n){let{playing:a=!1,designing:r=!1}=e;const o=L(),i=new Audio("/music/earthrock-final-theme.mp3");i.loop=!0,i.volume=.5;let s=!1;return t.$set=(t=>{"playing"in t&&n("playing",a=t.playing),"designing"in t&&n("designing",r=t.designing)}),{playing:a,designing:r,dispatch:o,audo_playing:s,toggle:()=>{s?i.pause():i.play(),n("audo_playing",s=!s)},click_handler:function(){return o("end")}}}class kt extends lt{constructor(t){super(),ct(this,t,vt,_t,s,["playing","designing"])}}function yt(e,n=t){let a;const r=[];function o(t){if(s(e,t)){if(e=t,!a)return;r.forEach(t=>t[1]()),r.forEach(t=>t[0](e))}}return{set:o,update:function(t){o(t(e))},subscribe:function(i,s=t){const c=[i,s];return r.push(c),1===r.length&&(a=n(o)||t),i(e),()=>{const t=r.indexOf(c);-1!==t&&r.splice(t,1),0===r.length&&(a(),a=null)}}}}const bt=yt(1),wt=()=>{const[t,e]=[window.innerWidth,window.innerHeight],n=t>e?e:t;bt.set(n/1e3)};window.addEventListener("resize",wt),wt();const xt=yt(1);function Mt(t){var e,a;const r=t.$$slots.default,o=function(t,e,n){if(t){const a=l(t,e,n);return t[0](a)}}(r,t,null);return{c(){e=y("div"),o&&o.c(),E(e,"class","spatial svelte-cjloal"),E(e,"style",t.style)},l(t){o&&o.l(div_nodes)},m(t,n){_(t,e,n),o&&o.m(e,null),a=!0},p(t,i){o&&o.p&&t.$$scope&&o.p(function(t,e,a,r){return t[1]?n({},n(e.$$scope.changed||{},t[1](r?r(a):{}))):e.$$scope.changed||{}}(r,i,t,null),l(r,i,null)),a&&!t.style||E(e,"style",i.style)},i(t){a||(Z(o,t),a=!0)},o(t){tt(o,t),a=!1},d(t){t&&v(e),o&&o.d(t)}}}function Et(t,e,n){let a;c(t,bt,t=>{n("$scaling",a=t)});let r,o,i,s,l,{position:d=[0,0],anchor:h=[50,50],bias:g=[50,50],area:u=[1,1],scale:f=1,rotate:$=0,autoscale:m=!0,zIndex:p=0}=e,{$$slots:_={},$$scope:v}=e;return t.$set=(t=>{"position"in t&&n("position",d=t.position),"anchor"in t&&n("anchor",h=t.anchor),"bias"in t&&n("bias",g=t.bias),"area"in t&&n("area",u=t.area),"scale"in t&&n("scale",f=t.scale),"rotate"in t&&n("rotate",$=t.rotate),"autoscale"in t&&n("autoscale",m=t.autoscale),"zIndex"in t&&n("zIndex",p=t.zIndex),"$$scope"in t&&n("$$scope",v=t.$$scope)}),t.$$.update=((t={anchor:1,bias:1,area:1,autoscale:1,scale:1,$scaling:1,position:1,offset:1,rotate:1,tru_scale:1,zIndex:1,tru_zIndex:1,transform:1})=>{t.anchor&&n("anchor",h=[h[0]<=50?`left: ${h[0]}%;`:`right: ${100-h[0]}%;`,h[1]<=50?`top: ${h[1]}%;`:`bottom: ${100-h[1]}%;`].join(" ")),(t.bias||t.area||t.anchor)&&n("offset",r=[.01*g[0]*u[0]/2*(h[0]<=50?-1:1),.01*g[1]*u[1]/2*(h[1]<=50?-1:1)]),(t.autoscale||t.scale||t.$scaling)&&n("tru_scale",o=m?f*a:f),(t.position||t.offset||t.rotate||t.tru_scale)&&n("transform",i=`transform: translate(${d[0]+r[0]}px, ${d[1]+r[1]}px) rotate(${$}deg) scale(${o});`),(t.scale||t.zIndex)&&n("tru_zIndex",s=`z-index: ${Math.max(1,Math.round(100*f+p))};`),(t.tru_zIndex||t.anchor||t.transform)&&n("style",l=[s,h,i].join(" "))}),{position:d,anchor:h,bias:g,area:u,scale:f,rotate:$,autoscale:m,zIndex:p,style:l,$$slots:_,$$scope:v}}setInterval(()=>{xt.set(rt(xt)+1)},100);class St extends lt{constructor(t){super(),ct(this,t,Et,Mt,s,["position","anchor","bias","area","scale","rotate","autoscale","zIndex"])}}const Ct=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}),It=t=>({id:Ct(),data:Tt(25),...t}),Tt=t=>{const e=[];for(let n=0;n<t;n++)e.push(Math.floor(1024*Math.random()));return e.join(" ")},zt=()=>({id:Ct(),name:Tt(5),image:Tt(25),cost:Math.floor(10*Math.random()),effect1:Tt(3),effect2:Tt(3),effect3:Tt(3)}),At=t=>{const e=[];for(let n=0;n<t;n++)e.push(zt());return e},Rt={faked:!1,tasks:{STATE:new Set},state:{away_deck:yt([]),away_hand:yt([]),away_discard:yt([]),away_field:yt([]),away_back:yt(""),home_deck:yt([]),home_hand:yt([]),home_discard:yt([]),home_field:yt([]),home_back:yt(""),home_gems:yt(0),away_gems:yt(0),home_hearts:yt(0),away_hearts:yt(0),home_tokens:yt([]),away_tokens:yt([])},server_fake:()=>{Rt.faked=(t=>{const e={away_deck:At(30),home_deck:At(30),away_hand:At(5),home_hand:At(5),away_back:Tt(15),home_back:Tt(15),home_discard:[],home_gems:Math.floor(10*Math.random()),home_hearts:Math.floor(6*Math.random()),away_hearts:Math.floor(6*Math.random()),away_discard:[],away_gems:Math.floor(10*Math.random()),away_tokens:[It({king:!0})]};e.home_tokens=[It({king:!0,data:e.home_back,color:90})];const n={PLAY:({id:a})=>{const{home_hand:r,home_discard:o}=e;for(let i=0;i<e.home_hand.length;i++){const s=e.home_hand[i];if(s.id===a)return r.splice(i,1),o.unshift(s),t.do({task:"STATE",data:{home_hand:r,home_discard:o}}),n.SUCCESS()}},DRAW:()=>{const{home_deck:a,home_hand:r}=e;return r.push(a.pop()),t.do({task:"STATE",data:{home_deck:a,home_hand:r}}),n.SUCCESS()},SUCCESS:()=>({code:200,text:"SuCcEsS"}),ERROR_404:()=>({code:404,text:"TaSk NoT FoUnD"})};return t.do({task:"STATE",data:e}),({task:t,data:e})=>n[t]?n[t](e):n.ERROR_404()})(Rt)},do:({task:t,data:e})=>{void 0!==Rt.tasks[t]?Rt.tasks[t].forEach(t=>t(e)):console.error(`Tried to call an undefined task ${t}`)},do_server:async t=>{if(Rt.faked)return Rt.faked(t);return(await fetch("/do",{method:"POST",mode:"same-origin",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()},when:(t,e)=>{if(void 0!==Rt.tasks[t])return Rt.tasks[t].add(e),()=>{Rt.tasks[t].delete(e)};console.error(`Tried to wait for an undefined task ${t}`)}};Rt.when("STATE",t=>Object.entries(t).forEach(([t,e])=>Rt.state[t].set(e)));const jt=yt([0,0]),Ot=[0,0];window.addEventListener("mousemove",t=>{Ot[0]=t.clientX,Ot[1]=t.clientY,Ot[0]===rt(jt)[0]&&Ot[1]===rt(jt)[1]||jt.set([...Ot])});const qt=new Promise(t=>{const e=new Image;e.src="/sheets/default.png",e.onload=(()=>{const n=document.createElement("canvas");n.width=e.width,n.height=e.height;const a=n.getContext("2d");a.drawImage(e,0,0),t({ctx:a,canvas:n})})}),Lt=new Map,Nt=(t,e)=>Math.floor(Math.random()*(Math.abs(t)+Math.abs(e))-Math.abs(t));var Pt=async({width:t,height:e,data:n,random:a=!1})=>{const{canvas:r}=await qt,o=`${t}:${e}:${n}`;if(!a&&Lt.has(o))return Lt.get(o);const i=document.createElement("canvas"),s=i.getContext("2d");if(i.width=16*t,i.height=16*e,a){let n,a,o,i;for(let c=0;c<t;c++)for(let t=0;t<e;t++)n=16*c,a=16*t,o=17*Nt(0,32),i=17*Nt(0,32),s.drawImage(r,o,i,16,16,n,a,16,16)}else if(n.length>0){let e,a;n.split(" ").forEach((n,o)=>{e=o%t,a=Math.floor(o/t);const i=parseInt(n,10),c=i%32,l=Math.floor(i/32),d=16*e,h=16*a,g=17*c,u=17*l;s.drawImage(r,g,u,16,16,d,h,16,16)})}const c=i.toDataURL("image/png");return a||Lt.set(KeyboardEvent,c),c};function Dt(e){var n;return{c(){E(n=y("img"),"class","tileset svelte-1bdmb53"),E(n,"alt","tileset image")},m(t,a){_(t,n,a),e.img_binding(n)},p:t,i:t,o:t,d(t){t&&v(n),e.img_binding(null)}}}function Ut(t,e,n){let a,{data:r="",width:o=10,height:i=7,spacing:s=0,random:c=!1}=e;return q(async()=>{a.src=await Pt({width:o,height:i,data:r,random:c}),n("image",a)}),t.$set=(t=>{"data"in t&&n("data",r=t.data),"width"in t&&n("width",o=t.width),"height"in t&&n("height",i=t.height),"spacing"in t&&n("spacing",s=t.spacing),"random"in t&&n("random",c=t.random)}),{data:r,width:o,height:i,spacing:s,random:c,image:a,img_binding:function(t){P[t?"unshift":"push"](()=>{n("image",a=t)})}}}class Wt extends lt{constructor(t){super(),ct(this,t,Ut,Dt,s,["data","width","height","spacing","random"])}}function Bt(t,e,n){const a=Object.create(t);return a.line=e[n],a}function Ht(t){var e,n,a,r,o,i,s;return{c(){e=y("div"),n=w(),a=y("div"),r=w(),o=y("div"),i=w(),s=y("div"),E(e,"class","border border-top svelte-1k8whng"),E(a,"class","border border-bottom svelte-1k8whng"),E(o,"class","border border-left svelte-1k8whng"),E(s,"class","border border-right svelte-1k8whng")},m(t,c){_(t,e,c),_(t,n,c),_(t,a,c),_(t,r,c),_(t,o,c),_(t,i,c),_(t,s,c)},d(t){t&&(v(e),v(n),v(a),v(r),v(o),v(i),v(s))}}}function Ft(t){var e,n,a,r,o,i,s,c,l,d,h,g,u,f=t.vitals[0],$=t.vitals[1],m=new Wt({props:{width:1,height:1,random:!0}}),k=new Wt({props:{width:1,height:1,random:!0}}),x=new Wt({props:{width:1,height:1,random:!0}});return{c(){e=y("div"),n=y("div"),a=y("div"),m.$$.fragment.c(),r=w(),o=y("div"),i=y("div"),k.$$.fragment.c(),s=w(),c=b(f),l=w(),d=y("div"),x.$$.fragment.c(),h=w(),g=b($),E(a,"class","tile svelte-1k8whng"),E(n,"class","icon svelte-1k8whng"),E(i,"class","tile svelte-1k8whng"),E(d,"class","tile svelte-1k8whng"),E(o,"class","vitals svelte-1k8whng"),E(e,"class","line svelte-1k8whng")},m(t,f){_(t,e,f),p(e,n),p(n,a),ot(m,a,null),p(e,r),p(e,o),p(o,i),ot(k,i,null),p(o,s),p(o,c),p(o,l),p(o,d),ot(x,d,null),p(o,h),p(o,g),u=!0},p(t,e){u&&!t.vitals||f===(f=e.vitals[0])||S(c,f),u&&!t.vitals||$===($=e.vitals[1])||S(g,$)},i(t){u||(Z(m.$$.fragment,t),Z(k.$$.fragment,t),Z(x.$$.fragment,t),u=!0)},o(t){tt(m.$$.fragment,t),tt(k.$$.fragment,t),tt(x.$$.fragment,t),u=!1},d(t){t&&v(e),it(m),it(k),it(x)}}}function Kt(t){for(var e,n,a,r,i,s,c,l,d,h,g,u,f,$,m,x,T,z,A,R,j,O,q,L=t.borders&&Ht(),N=new Wt({props:{width:3,height:5,data:t.back}}),P=new Wt({props:{data:t.name,width:5,height:1}}),D=new Wt({props:{width:5,height:5,data:t.image}}),U=t.lines,W=[],B=0;B<U.length;B+=1)W[B]=Ft(Bt(t,U,B));const H=t=>tt(W[t],1,1,()=>{W[t]=null});return{c(){e=y("div"),n=y("div"),L&&L.c(),a=w(),r=y("div"),N.$$.fragment.c(),i=w(),s=y("div"),c=y("div"),l=y("div"),P.$$.fragment.c(),d=w(),h=y("div"),g=w(),u=y("div"),f=b(t.cost),$=w(),m=y("div"),D.$$.fragment.c(),x=w(),T=y("div");for(var o=0;o<W.length;o+=1)W[o].c();z=w(),A=y("div"),R=w(),(j=y("div")).textContent="E A R T H R O C K",E(r,"class","back svelte-1k8whng"),C(r,"filter","sepia(1) hue-rotate("+t.color+"deg) brightness("+(t.fade?.5:1)+")"),E(l,"class","title svelte-1k8whng"),E(h,"class","flex svelte-1k8whng"),E(u,"class","cost svelte-1k8whng"),E(c,"class","header svelte-1k8whng"),E(m,"class","image svelte-1k8whng"),E(A,"class","flex svelte-1k8whng"),E(T,"class","details svelte-1k8whng"),E(j,"class","earthrock svelte-1k8whng"),E(s,"class","front svelte-1k8whng"),E(n,"class","contents svelte-1k8whng"),I(n,"flip",t.flip),E(e,"style",t.style),E(e,"class","card svelte-1k8whng"),I(e,"fade",t.fade),I(e,"dragging",t.dragging),q=[M(r,"click",t.beginInteract),M(s,"mousedown",t.beginInteract),M(e,"mouseenter",t.delay_hover.on),M(e,"mouseleave",t.delay_hover.off)]},m(t,o){_(t,e,o),p(e,n),L&&L.m(n,null),p(n,a),p(n,r),ot(N,r,null),p(n,i),p(n,s),p(s,c),p(c,l),ot(P,l,null),p(c,d),p(c,h),p(c,g),p(c,u),p(u,f),p(s,$),p(s,m),ot(D,m,null),p(s,x),p(s,T);for(var v=0;v<W.length;v+=1)W[v].m(T,null);p(T,z),p(T,A),p(s,R),p(s,j),O=!0},p(t,o){o.borders?L||((L=Ht()).c(),L.m(n,a)):L&&(L.d(1),L=null);var i={};t.back&&(i.data=o.back),N.$set(i),(!O||t.color||t.fade)&&C(r,"filter","sepia(1) hue-rotate("+o.color+"deg) brightness("+(o.fade?.5:1)+")");var s={};t.name&&(s.data=o.name),P.$set(s),O&&!t.cost||S(f,o.cost);var c={};if(t.image&&(c.data=o.image),D.$set(c),t.vitals||t.lines){U=o.lines;for(var l=0;l<U.length;l+=1){const e=Bt(o,U,l);W[l]?(W[l].p(t,e),Z(W[l],1)):(W[l]=Ft(e),W[l].c(),Z(W[l],1),W[l].m(T,z))}for(Q(),l=U.length;l<W.length;l+=1)H(l);V()}t.flip&&I(n,"flip",o.flip),O&&!t.style||E(e,"style",o.style),t.fade&&I(e,"fade",o.fade),t.dragging&&I(e,"dragging",o.dragging)},i(t){if(!O){Z(N.$$.fragment,t),Z(P.$$.fragment,t),Z(D.$$.fragment,t);for(var e=0;e<U.length;e+=1)Z(W[e]);O=!0}},o(t){tt(N.$$.fragment,t),tt(P.$$.fragment,t),tt(D.$$.fragment,t),W=W.filter(Boolean);for(let t=0;t<W.length;t+=1)tt(W[t]);O=!1},d(t){t&&v(e),L&&L.d(),it(N),it(P),it(D),k(W,t),o(q)}}}const Yt=.5;function Gt(t,e,n){let a;c(t,jt,t=>{n("$mouse_pos",a=t)});const r=L();let{deck:o="",id:i="foobar",cost:s=0,name:l="16 55 33 44 55",image:d="",effect1:h="",effect2:g="",effect3:u="",back:f="",borders:$=!0,vitals:m=[1,1],invert:p=!1,interact:_=!0,drag:v=!1,position:k=[0,0],position_raw:y=!1,rotation:b=0,scale:w=1,color:x=90,card:M={},young:E=!0,fade:S=!1,anchor:C=[50,50]}=e;const I=[h,g,u];let T=!0;q(()=>{setTimeout(()=>{n("young",E=!1),n("flip",T=!_)},250)});let z=!1;const A=(({time:t=250,on:e=(()=>{}),off:n=(()=>{})})=>{let a;return{on:()=>{_&&(a&&clearTimeout(a),e())},off:()=>{_&&(a&&clearTimeout(a),a=setTimeout(()=>{a=0,n()},t))}}})({time:100,on:()=>{n("hover",B=!0)},off:()=>{const t=B=!1;return n("hover",B),t}});let R,j,O,N,P,D,U,W,B=!1;return t.$set=(t=>{"deck"in t&&n("deck",o=t.deck),"id"in t&&n("id",i=t.id),"cost"in t&&n("cost",s=t.cost),"name"in t&&n("name",l=t.name),"image"in t&&n("image",d=t.image),"effect1"in t&&n("effect1",h=t.effect1),"effect2"in t&&n("effect2",g=t.effect2),"effect3"in t&&n("effect3",u=t.effect3),"back"in t&&n("back",f=t.back),"borders"in t&&n("borders",$=t.borders),"vitals"in t&&n("vitals",m=t.vitals),"invert"in t&&n("invert",p=t.invert),"interact"in t&&n("interact",_=t.interact),"drag"in t&&n("drag",v=t.drag),"position"in t&&n("position",k=t.position),"position_raw"in t&&n("position_raw",y=t.position_raw),"rotation"in t&&n("rotation",b=t.rotation),"scale"in t&&n("scale",w=t.scale),"color"in t&&n("color",x=t.color),"card"in t&&n("card",M=t.card),"young"in t&&n("young",E=t.young),"fade"in t&&n("fade",S=t.fade),"anchor"in t&&n("anchor",C=t.anchor)}),t.$$.update=((t={hover:1,scale:1,rotation:1,invert:1,dragging:1,anchor:1,tru_anchor:1,$mouse_pos:1,tru_width:1,tru_height:1,position_raw:1,tru_rotation:1,tru_scale:1,position:1,tru_invert:1,transforms:1})=>{(t.hover||t.scale)&&n("tru_scale",R=B?1.168*w:w),(t.hover||t.rotation)&&n("tru_rotation",j=B?0:b),t.invert&&n("tru_invert",O=p?-1:1),(t.dragging||t.anchor)&&n("tru_anchor",N=z?[50,50]:C),t.tru_anchor&&n("tru_width",P=250*(N[0]<=50?-1:1)),t.tru_anchor&&n("tru_height",D=400*(N[1]<=50?-1:1)),(t.dragging||t.$mouse_pos||t.tru_width||t.tru_height||t.position_raw||t.tru_rotation||t.tru_scale||t.position||t.hover||t.tru_invert)&&n("transforms",U=z?`transform: translate(${a[0]-window.innerWidth/2+P}px, ${a[1]-window.innerHeight/2+D}px) rotate(0deg) scale(${Yt});z-index: 100`:y?`transform: translate(${y[0]-window.innerWidth/2-P}px, ${y[1]-window.innerHeight/2-D}px) rotate(${j}deg) scale(${R}) ; z-index: ${Math.round(100*R)}`:`transform: translate(${5*k[0]+P}px, ${8*(k[1]+(B?-5*O:0))+D}px) rotate(${j}deg) scale(${R}) ; z-index: ${Math.round(100*R)}`),(t.transforms||t.tru_anchor)&&n("style",W=[U,N[0]<=50?`left: ${N[0]}%`:`right: ${100-N[0]}%`,N[1]<=50?`top: ${N[1]}%`:`bottom: ${100-N[1]}%`].join(";"))}),{deck:o,id:i,cost:s,name:l,image:d,effect1:h,effect2:g,effect3:u,back:f,borders:$,vitals:m,invert:p,interact:_,drag:v,position:k,position_raw:y,rotation:b,scale:w,color:x,card:M,young:E,fade:S,anchor:C,lines:I,flip:T,dragging:z,beginInteract:()=>{if(r("click",M),v){n("dragging",z=!0);const t=window.addEventListener("mouseup",()=>{r("dragend",M),n("dragging",z=!1),window.removeEventListener("mouseup",t)})}},delay_hover:A,style:W}}class Xt extends lt{constructor(t){super(),ct(this,t,Gt,Kt,s,["deck","id","cost","name","image","effect1","effect2","effect3","back","borders","vitals","invert","interact","drag","position","position_raw","rotation","scale","color","card","young","fade","anchor"])}}function Jt(t,e,n){const a=Object.create(t);return a.card=e[n],a.index=n,a}function Qt(t){var e,a=[t.card,{scale:t.scale*t.$scaling},{invert:t.invert},{interact:t.interact},{color:t.color},{card:t.card},{drag:t.drag},{fade:t.fade},{anchor:t.anchor},{back:t.$back},{position:90===t.Math.abs(t.rotation)?[t.position[0],t.position[1]+t.tru_index(t.index)*t.tru_spread-t.tru_length/2*t.tru_spread]:[t.position[0]+t.tru_index(t.index)*t.tru_spread-t.tru_length/2*t.tru_spread,t.position[1]+(t.invert?-1:1)*t.Math.abs(t.tru_index(t.index)-t.tru_length/2)*t.spread_y]},{rotation:t.rotation+(t.tru_index(t.index)-t.tru_length/2)*t.tru_rotate*(t.invert?-1:1)+(t.invert?180:0)}];let r={};for(var o=0;o<a.length;o+=1)r=n(r,a[o]);var i=new Xt({props:r});return i.$on("dragend",t.dragend_handler),i.$on("click",t.click_handler),{c(){i.$$.fragment.c()},m(t,n){ot(i,t,n),e=!0},p(t,e){var n=t.$cards||t.scale||t.$scaling||t.invert||t.interact||t.color||t.drag||t.fade||t.anchor||t.$back||t.Math||t.rotation||t.position||t.tru_index||t.tru_spread||t.tru_length||t.spread_y||t.tru_rotate?at(a,[t.$cards&&e.card,(t.scale||t.$scaling)&&{scale:e.scale*e.$scaling},t.invert&&{invert:e.invert},t.interact&&{interact:e.interact},t.color&&{color:e.color},t.$cards&&{card:e.card},t.drag&&{drag:e.drag},t.fade&&{fade:e.fade},t.anchor&&{anchor:e.anchor},t.$back&&{back:e.$back},(t.Math||t.rotation||t.position||t.tru_index||t.$cards||t.tru_spread||t.tru_length||t.invert||t.spread_y)&&{position:90===e.Math.abs(e.rotation)?[e.position[0],e.position[1]+e.tru_index(e.index)*e.tru_spread-e.tru_length/2*e.tru_spread]:[e.position[0]+e.tru_index(e.index)*e.tru_spread-e.tru_length/2*e.tru_spread,e.position[1]+(e.invert?-1:1)*e.Math.abs(e.tru_index(e.index)-e.tru_length/2)*e.spread_y]},(t.rotation||t.tru_index||t.$cards||t.tru_length||t.tru_rotate||t.invert)&&{rotation:e.rotation+(e.tru_index(e.index)-e.tru_length/2)*e.tru_rotate*(e.invert?-1:1)+(e.invert?180:0)}]):{};i.$set(n)},i(t){e||(Z(i.$$.fragment,t),e=!0)},o(t){tt(i.$$.fragment,t),e=!1},d(t){it(i,t)}}}function Vt(t,e){var n,a,r,o=e.tru_index(e.index)<e.max&&Qt(e);return{key:t,first:null,c(){n=x(),o&&o.c(),a=x(),this.first=n},m(t,e){_(t,n,e),o&&o.m(t,e),_(t,a,e),r=!0},p(t,e){e.tru_index(e.index)<e.max?o?(o.p(t,e),Z(o,1)):((o=Qt(e)).c(),Z(o,1),o.m(a.parentNode,a)):o&&(Q(),tt(o,1,1,()=>{o=null}),V())},i(t){r||(Z(o),r=!0)},o(t){tt(o),r=!1},d(t){t&&v(n),o&&o.d(t),t&&v(a)}}}function Zt(t){var e,n,a=[],r=new Map,o=t.$cards;const i=t=>t.card.id;for(var s=0;s<o.length;s+=1){let e=Jt(t,o,s),n=i(e);r.set(n,a[s]=Vt(n,e))}return{c(){for(s=0;s<a.length;s+=1)a[s].c();e=x()},m(t,r){for(s=0;s<a.length;s+=1)a[s].m(t,r);_(t,e,r),n=!0},p(t,n){const o=n.$cards;Q(),a=function(t,e,n,a,r,o,i,s,c,l,d,h){let g=t.length,u=o.length,f=g;const $={};for(;f--;)$[t[f].key]=f;const m=[],p=new Map,_=new Map;for(f=u;f--;){const t=h(r,o,f),s=n(t);let c=i.get(s);c?a&&c.p(e,t):(c=l(s,t)).c(),p.set(s,m[f]=c),s in $&&_.set(s,Math.abs(f-$[s]))}const v=new Set,k=new Set;function y(t){Z(t,1),t.m(s,d),i.set(t.key,t),d=t.first,u--}for(;g&&u;){const e=m[u-1],n=t[g-1],a=e.key,r=n.key;e===n?(d=e.first,g--,u--):p.has(r)?!i.has(a)||v.has(a)?y(e):k.has(r)?g--:_.get(a)>_.get(r)?(k.add(a),y(e)):(v.add(r),g--):(c(n,i),g--)}for(;g--;){const e=t[g];p.has(e.key)||c(e,i)}for(;u;)y(m[u-1]);return m}(a,t,i,1,n,o,r,e.parentNode,nt,Vt,e,Jt),V()},i(t){if(!n){for(var e=0;e<o.length;e+=1)Z(a[e]);n=!0}},o(t){for(s=0;s<a.length;s+=1)tt(a[s]);n=!1},d(t){for(s=0;s<a.length;s+=1)a[s].d(t);t&&v(e)}}}function te(t,e,n){let a,r,o;c(t,bt,t=>{n("$scaling",r=t)});const i=L();let{cards:s=yt([]),max:l=10,position:d=[0,0],anchor:h=[50,50],invert:g=!1,fade:u=!1,drag:f=!1,reverse:$=!1,scale:m=1,spread:p=10,spread_y:_=1,interact:v=!0,rotate:k=3,rotation:y=0,color:b=90}=e;c(t,s,t=>{n("$cards",a=t)});let{back:w=yt("")}=e;c(t,w,t=>{n("$back",o=t)});let x,M,E,S;return t.$set=(t=>{"cards"in t&&n("cards",s=t.cards),"max"in t&&n("max",l=t.max),"position"in t&&n("position",d=t.position),"anchor"in t&&n("anchor",h=t.anchor),"invert"in t&&n("invert",g=t.invert),"fade"in t&&n("fade",u=t.fade),"drag"in t&&n("drag",f=t.drag),"reverse"in t&&n("reverse",$=t.reverse),"scale"in t&&n("scale",m=t.scale),"spread"in t&&n("spread",p=t.spread),"spread_y"in t&&n("spread_y",_=t.spread_y),"interact"in t&&n("interact",v=t.interact),"rotate"in t&&n("rotate",k=t.rotate),"rotation"in t&&n("rotation",y=t.rotation),"color"in t&&n("color",b=t.color),"back"in t&&n("back",w=t.back)}),t.$$.update=((t={$cards:1,max:1,tru_length:1,spread:1,x_factor:1,$scaling:1,rotate:1})=>{(t.$cards||t.max)&&n("tru_length",x=a.length>l?l:a.length),(t.tru_length||t.max)&&n("x_factor",M=Math.max(x/l,.5)),(t.spread||t.x_factor||t.$scaling)&&n("tru_spread",E=p/M*r),(t.rotate||t.x_factor)&&n("tru_rotate",S=k/M)}),{dispatch:i,cards:s,max:l,position:d,anchor:h,invert:g,fade:u,drag:f,reverse:$,scale:m,spread:p,spread_y:_,interact:v,rotate:k,rotation:y,color:b,back:w,tru_index:t=>$?a.length-t:t,tru_length:x,$cards:a,Math:Math,tru_spread:E,$scaling:r,tru_rotate:S,$back:o,dragend_handler:function({detail:t}){return i("dragend",t)},click_handler:function({detail:t}){return i("click",t)}}}class ee extends lt{constructor(t){super(),ct(this,t,te,Zt,s,["cards","max","position","anchor","invert","fade","drag","reverse","scale","spread","spread_y","interact","rotate","rotation","color","back"])}}function ne(t){var e,n,a,r=new Wt({props:{data:(t.is_first?180:68).toString(),width:1,height:1}});return{c(){e=y("div"),r.$$.fragment.c(),E(e,"class","gem svelte-5vpisz"),E(e,"style",n=`filter: sepia(0.5) hue-rotate(${t.hue}) brightness(${t.bright_default+.168*Math.sin(t.i)});`),I(e,"empty",t.empty)},m(t,n){_(t,e,n),ot(r,e,null),a=!0},p(t,o){var i={};t.is_first&&(i.data=(o.is_first?180:68).toString()),r.$set(i),(!a||t.hue||t.bright_default||t.i)&&n!==(n=`filter: sepia(0.5) hue-rotate(${o.hue}) brightness(${o.bright_default+.168*Math.sin(o.i)});`)&&E(e,"style",n),t.empty&&I(e,"empty",o.empty)},i(t){a||(Z(r.$$.fragment,t),a=!0)},o(t){tt(r.$$.fragment,t),a=!1},d(t){t&&v(e),it(r)}}}function ae(t,e,n){let a,r,o,{empty:i=!1,i:s=0}=e;return t.$set=(t=>{"empty"in t&&n("empty",i=t.empty),"i"in t&&n("i",s=t.i)}),t.$$.update=((t={i:1,empty:1})=>{t.i&&n("is_first",a=s%9!=0),t.empty&&n("bright_default",r=i?.25:.75),t.empty&&n("hue",o=`${i?-90:90}deg`)}),{empty:i,i:s,is_first:a,bright_default:r,hue:o}}class re extends lt{constructor(t){super(),ct(this,t,ae,ne,s,["empty","i"])}}function oe(t){var e,n,a,r=new Wt({props:{data:"88",width:1,height:1}});return{c(){e=y("div"),r.$$.fragment.c(),E(e,"class","heart svelte-198lepj"),E(e,"style",n=`filter:sepia(1) hue-rotate(${t.hue}) brightness(${t.bright_default+.168*Math.sin(t.i)});`),I(e,"empty",t.empty)},m(t,n){_(t,e,n),ot(r,e,null),a=!0},p(t,r){(!a||t.hue||t.bright_default||t.i)&&n!==(n=`filter:sepia(1) hue-rotate(${r.hue}) brightness(${r.bright_default+.168*Math.sin(r.i)});`)&&E(e,"style",n),t.empty&&I(e,"empty",r.empty)},i(t){a||(Z(r.$$.fragment,t),a=!0)},o(t){tt(r.$$.fragment,t),a=!1},d(t){t&&v(e),it(r)}}}function ie(t,e,n){let a,r,{empty:o=!1,i:i=0}=e;return t.$set=(t=>{"empty"in t&&n("empty",o=t.empty),"i"in t&&n("i",i=t.i)}),t.$$.update=((t={i:1,empty:1})=>{t.i,t.empty&&n("bright_default",a=o?0:.9)}),n("hue",r="230deg"),{empty:o,i:i,bright_default:a,hue:"230deg"}}class se extends lt{constructor(t){super(),ct(this,t,ie,oe,s,["empty","i"])}}function ce(t){var e,n,a=new Wt({props:{width:t.grid[0],height:t.grid[1],data:t.data}});return{c(){e=y("div"),a.$$.fragment.c(),E(e,"class","token svelte-p51kfu"),E(e,"style",t.style),I(e,"king",t.king)},m(t,r){_(t,e,r),ot(a,e,null),n=!0},p(t,r){var o={};t.grid&&(o.width=r.grid[0]),t.grid&&(o.height=r.grid[1]),t.data&&(o.data=r.data),a.$set(o),n&&!t.style||E(e,"style",r.style),t.king&&I(e,"king",r.king)},i(t){n||(Z(a.$$.fragment,t),n=!0)},o(t){tt(a.$$.fragment,t),n=!1},d(t){t&&v(e),it(a)}}}function le(t,e,n){let a,r,{king:o=!1,data:i="",color:s=0}=e;return t.$set=(t=>{"king"in t&&n("king",o=t.king),"data"in t&&n("data",i=t.data),"color"in t&&n("color",s=t.color)}),t.$$.update=((t={king:1,color:1})=>{t.king&&n("grid",a=o?[3,5]:[5,5]),t.color&&n("style",r=`filter:sepia(1) hue-rotate(${s}deg);`)}),{king:o,data:i,color:s,grid:a,style:r}}class de extends lt{constructor(t){super(),ct(this,t,le,ce,s,["king","data","color"])}}const he=({max:t=9,radius:e=50,offset:n=0,wobble:a=[.5,20]}=!1)=>({i:n,scale:r})=>{const o=n/t*2*Math.PI,i=r*(e+Math.sin(n+a[0])*a[1]);return[i*Math.cos(o),i*Math.sin(o)]};function ge(t,e,n){const a=Object.create(t);return a.item=e[n],a.i=n,a}function ue(t,e,n){const a=Object.create(t);return a.item=e[n],a.i=n,a}function fe(t,e,n){const a=Object.create(t);return a.item=e[n],a.i=n,a}function $e(t){var e,a,r=[t.item,{i:t.i%8==0?0:t.i+.25*t.$tick}];let o={};for(var i=0;i<r.length;i+=1)o=n(o,r[i]);var s=new re({props:o});return{c(){s.$$.fragment.c(),e=w()},m(t,n){ot(s,t,n),_(t,e,n),a=!0},p(t,e){var n=t.arr_home_gems||t.$tick?at(r,[t.arr_home_gems&&e.item,t.$tick&&{i:e.i%8==0?0:e.i+.25*e.$tick}]):{};s.$set(n)},i(t){a||(Z(s.$$.fragment,t),a=!0)},o(t){tt(s.$$.fragment,t),a=!1},d(t){it(s,t),t&&v(e)}}}function me(t){var e,n=new St({props:{anchor:[50,70],bias:[50,100],position:t.circle({i:t.i+.368*t.$tick,scale:t.$scaling}),scale:1+.1*Math.sin(t.i-.5*t.$tick),rotate:90+45*Math.abs(Math.sin(t.i-.05*t.$tick)),$$slots:{default:[$e]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,a){ot(n,t,a),e=!0},p(t,e){var a={};(t.circle||t.$tick||t.$scaling)&&(a.position=e.circle({i:e.i+.368*e.$tick,scale:e.$scaling})),t.$tick&&(a.scale=1+.1*Math.sin(e.i-.5*e.$tick)),t.$tick&&(a.rotate=90+45*Math.abs(Math.sin(e.i-.05*e.$tick))),(t.$$scope||t.arr_home_gems||t.$tick)&&(a.$$scope={changed:t,ctx:e}),n.$set(a)},i(t){e||(Z(n.$$.fragment,t),e=!0)},o(t){tt(n.$$.fragment,t),e=!1},d(t){it(n,t)}}}function pe(t){var e,a=[t.item,{i:t.i}];let r={};for(var o=0;o<a.length;o+=1)r=n(r,a[o]);var i=new se({props:r});return{c(){i.$$.fragment.c()},m(t,n){ot(i,t,n),e=!0},p(t,e){var n=t.arr_home_hearts?at(a,[e.item,{i:e.i}]):{};i.$set(n)},i(t){e||(Z(i.$$.fragment,t),e=!0)},o(t){tt(i.$$.fragment,t),e=!1},d(t){it(i,t)}}}function _e(t){var e,n=new St({props:{anchor:[50,70],bias:[50,50],zIndex:-20,position:t.circle_heart({i:t.i+.168*t.$tick,scale:t.$scaling}),scale:1+.1*Math.sin(t.i-.5*t.$tick),$$slots:{default:[pe]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,a){ot(n,t,a),e=!0},p(t,e){var a={};(t.circle_heart||t.$tick||t.$scaling)&&(a.position=e.circle_heart({i:e.i+.168*e.$tick,scale:e.$scaling})),t.$tick&&(a.scale=1+.1*Math.sin(e.i-.5*e.$tick)),(t.$$scope||t.arr_home_hearts)&&(a.$$scope={changed:t,ctx:e}),n.$set(a)},i(t){e||(Z(n.$$.fragment,t),e=!0)},o(t){tt(n.$$.fragment,t),e=!1},d(t){it(n,t)}}}function ve(t){var e,a,r=[t.item,{i:t.i}];let o={};for(var i=0;i<r.length;i+=1)o=n(o,r[i]);var s=new de({props:o});return{c(){s.$$.fragment.c(),e=w()},m(t,n){ot(s,t,n),_(t,e,n),a=!0},p(t,e){var n=t.$home_tokens?at(r,[e.item,{i:e.i}]):{};s.$set(n)},i(t){a||(Z(s.$$.fragment,t),a=!0)},o(t){tt(s.$$.fragment,t),a=!1},d(t){it(s,t),t&&v(e)}}}function ke(t){var e,n=new St({props:{anchor:[50,70],bias:[50,50],zIndex:-1e3,area:[-30,-40],position:[0,25],scale:3+.1*Math.sin(t.i-.168*t.$tick),$$slots:{default:[ve]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,a){ot(n,t,a),e=!0},p(t,e){var a={};t.$tick&&(a.scale=3+.1*Math.sin(e.i-.168*e.$tick)),(t.$$scope||t.$home_tokens)&&(a.$$scope={changed:t,ctx:e}),n.$set(a)},i(t){e||(Z(n.$$.fragment,t),e=!0)},o(t){tt(n.$$.fragment,t),e=!1},d(t){it(n,t)}}}function ye(t){var e,a,r,o,i,s,c,l,d,h,g,u,f,$=new ee({props:{cards:Rt.state.home_hand,scale:be,position:[0,0],back:Rt.state.home_back,drag:!0,anchor:[50,90]}});$.$on("dragend",t.dragend_handler);var m=[t.deck,{anchor:[90,70]},{cards:Rt.state.home_deck},{position:[0,0]},{back:Rt.state.home_back}];let b={};for(var x=0;x<m.length;x+=1)b=n(b,m[x]);var M=new ee({props:b});M.$on("click",t.click_handler);var S=new ee({props:{cards:t.play_home,position:[0,0],anchor:[50,50],scale:"0.4",back:Rt.state.home_back}}),C=new ee({props:{cards:t.play_away,position:[0,0],anchor:[50,50],scale:"0.4",back:Rt.state.away_back}}),I=[t.discard,{cards:Rt.state.home_discard},{position:[0,0]},{anchor:[0,90]},{back:Rt.state.home_back}];let T={};for(x=0;x<I.length;x+=1)T=n(T,I[x]);var z=new ee({props:T}),A=new ee({props:{cards:Rt.state.away_hand,scale:be,anchor:[50,0],interact:!1,color:180,invert:!0,back:Rt.state.away_back}}),R=[t.deck,{cards:Rt.state.away_deck},{color:180},{anchor:[90,30]},{back:Rt.state.away_back}];let j={};for(x=0;x<R.length;x+=1)j=n(j,R[x]);var O=new ee({props:j}),q=[t.discard,{cards:Rt.state.away_discard},{anchor:[0,10]},{back:Rt.state.away_back}];let L={};for(x=0;x<q.length;x+=1)L=n(L,q[x]);var N=new ee({props:L}),P=t.arr_home_gems,D=[];for(x=0;x<P.length;x+=1)D[x]=me(fe(t,P,x));const U=t=>tt(D[t],1,1,()=>{D[t]=null});var W=t.arr_home_hearts,B=[];for(x=0;x<W.length;x+=1)B[x]=_e(ue(t,W,x));const H=t=>tt(B[t],1,1,()=>{B[t]=null});var F=t.$home_tokens,K=[];for(x=0;x<F.length;x+=1)K[x]=ke(ge(t,F,x));const Y=t=>tt(K[t],1,1,()=>{K[t]=null});return{c(){e=y("div"),$.$$.fragment.c(),a=w(),M.$$.fragment.c(),r=w(),S.$$.fragment.c(),o=w(),C.$$.fragment.c(),i=w(),z.$$.fragment.c(),s=w(),A.$$.fragment.c(),c=w(),O.$$.fragment.c(),l=w(),N.$$.fragment.c(),d=w();for(var t=0;t<D.length;t+=1)D[t].c();h=w();for(t=0;t<B.length;t+=1)B[t].c();g=w();for(t=0;t<K.length;t+=1)K[t].c();E(e,"class","game svelte-1bvhcmr")},m(t,n){_(t,e,n),ot($,e,null),p(e,a),ot(M,e,null),p(e,r),ot(S,e,null),p(e,o),ot(C,e,null),p(e,i),ot(z,e,null),p(e,s),ot(A,e,null),p(e,c),ot(O,e,null),p(e,l),ot(N,e,null),p(e,d);for(var u=0;u<D.length;u+=1)D[u].m(e,null);p(e,h);for(u=0;u<B.length;u+=1)B[u].m(e,null);p(e,g);for(u=0;u<K.length;u+=1)K[u].m(e,null);f=!0},p(t,n){var a={};t.game&&(a.cards=Rt.state.home_hand),t.scale&&(a.scale=be),t.game&&(a.back=Rt.state.home_back),$.$set(a);var r=t.deck||t.game?at(m,[t.deck&&n.deck,{anchor:[90,70]},t.game&&{cards:Rt.state.home_deck},{position:[0,0]},t.game&&{back:Rt.state.home_back}]):{};M.$set(r);var o={};t.play_home&&(o.cards=n.play_home),t.game&&(o.back=Rt.state.home_back),S.$set(o);var i={};t.play_away&&(i.cards=n.play_away),t.game&&(i.back=Rt.state.away_back),C.$set(i);var s=t.discard||t.game?at(I,[t.discard&&n.discard,t.game&&{cards:Rt.state.home_discard},{position:[0,0]},{anchor:[0,90]},t.game&&{back:Rt.state.home_back}]):{};z.$set(s);var c={};t.game&&(c.cards=Rt.state.away_hand),t.scale&&(c.scale=be),t.game&&(c.back=Rt.state.away_back),A.$set(c);var l=t.deck||t.game?at(R,[t.deck&&n.deck,t.game&&{cards:Rt.state.away_deck},{color:180},{anchor:[90,30]},t.game&&{back:Rt.state.away_back}]):{};O.$set(l);var d=t.discard||t.game?at(q,[t.discard&&n.discard,t.game&&{cards:Rt.state.away_discard},{anchor:[0,10]},t.game&&{back:Rt.state.away_back}]):{};if(N.$set(d),t.circle||t.$tick||t.$scaling||t.arr_home_gems){P=n.arr_home_gems;for(var u=0;u<P.length;u+=1){const a=fe(n,P,u);D[u]?(D[u].p(t,a),Z(D[u],1)):(D[u]=me(a),D[u].c(),Z(D[u],1),D[u].m(e,h))}for(Q(),u=P.length;u<D.length;u+=1)U(u);V()}if(t.circle_heart||t.$tick||t.$scaling||t.arr_home_hearts){W=n.arr_home_hearts;for(u=0;u<W.length;u+=1){const a=ue(n,W,u);B[u]?(B[u].p(t,a),Z(B[u],1)):(B[u]=_e(a),B[u].c(),Z(B[u],1),B[u].m(e,g))}for(Q(),u=W.length;u<B.length;u+=1)H(u);V()}if(t.$tick||t.$home_tokens){F=n.$home_tokens;for(u=0;u<F.length;u+=1){const a=ge(n,F,u);K[u]?(K[u].p(t,a),Z(K[u],1)):(K[u]=ke(a),K[u].c(),Z(K[u],1),K[u].m(e,null))}for(Q(),u=F.length;u<K.length;u+=1)Y(u);V()}},i(t){if(!f){Z($.$$.fragment,t),Z(M.$$.fragment,t),Z(S.$$.fragment,t),Z(C.$$.fragment,t),Z(z.$$.fragment,t),Z(A.$$.fragment,t),Z(O.$$.fragment,t),Z(N.$$.fragment,t);for(var e=0;e<P.length;e+=1)Z(D[e]);for(e=0;e<W.length;e+=1)Z(B[e]);for(e=0;e<F.length;e+=1)Z(K[e]);u&&u.end(1),f=!0}},o(t){tt($.$$.fragment,t),tt(M.$$.fragment,t),tt(S.$$.fragment,t),tt(C.$$.fragment,t),tt(z.$$.fragment,t),tt(A.$$.fragment,t),tt(O.$$.fragment,t),tt(N.$$.fragment,t),D=D.filter(Boolean);for(let t=0;t<D.length;t+=1)tt(D[t]);B=B.filter(Boolean);for(let t=0;t<B.length;t+=1)tt(B[t]);K=K.filter(Boolean);for(let t=0;t<K.length;t+=1)tt(K[t]);u=et(e,gt,{delay:100,duration:1e3,x:0,y:1e3,opacity:0}),f=!1},d(t){t&&v(e),it($),it(M),it(S),it(C),it(z),it(A),it(O),it(N),k(D,t),k(B,t),k(K,t),t&&u&&u.end()}}}const be=.25;function we(t,e,n){let a,r,o,i,s;c(t,xt,t=>{n("$tick",o=t)}),c(t,bt,t=>{n("$scaling",i=t)});const{home_gems:l,home_hearts:d,home_tokens:h}=Rt.state;c(t,l,t=>{n("$home_gems",a=t)}),c(t,d,t=>{n("$home_hearts",r=t)}),c(t,h,t=>{n("$home_tokens",s=t)});const g={scale:be,spread:0,max:4,reverse:!0,interact:!1},u=he({max:32,radius:75}),f=he({max:6,radius:15}),$=yt([]),m=yt([]),p={scale:be,spread:5,spread_y:0,rotate:0,rotation:90,fade:!0,drag:!0,max:10};let _,v;return Rt.server_fake(),t.$$.update=((t={$home_gems:1,$home_hearts:1})=>{t.$home_gems&&n("arr_home_gems",_=Array.from(Array(9)).map((t,e)=>({empty:e<a}))),t.$home_hearts&&n("arr_home_hearts",v=Array.from(Array(6)).map((t,e)=>({empty:e<r})))}),{home_gems:l,home_hearts:d,home_tokens:h,deck:g,circle:u,circle_heart:f,play_home:$,play_away:m,discard:p,arr_home_gems:_,arr_home_hearts:v,$tick:o,$scaling:i,$home_tokens:s,dragend_handler:function({detail:{id:t}}){Rt.do_server({task:"PLAY",data:{id:t}})},click_handler:function(){Rt.do_server({task:"DRAW"})}}}class xe extends lt{constructor(t){super(),ct(this,t,we,ye,s,[])}}function Me(e){var n,a,r;return{c(){(n=y("div")).textContent="Still Ruff",E(n,"class","design svelte-1hbrshb")},m(t,e){_(t,n,e),r=!0},p:t,i(t){r||(a&&a.end(1),r=!0)},o(t){a=et(n,ht,{duration:100}),r=!1},d(t){t&&(v(n),a&&a.end())}}}function Ee(t){var e,n=new St({props:{bias:[50,50],anchor:[50,50],area:[-1e3,50],$$slots:{default:[Me]},$$scope:{ctx:t}}});return{c(){n.$$.fragment.c()},m(t,a){ot(n,t,a),e=!0},p(t,e){var a={};t.$$scope&&(a.$$scope={changed:t,ctx:e}),n.$set(a)},i(t){e||(Z(n.$$.fragment,t),e=!0)},o(t){tt(n.$$.fragment,t),e=!1},d(t){it(n,t)}}}class Se extends lt{constructor(t){super(),ct(this,t,null,Ee,s,[])}}function Ce(t){var e,n=new mt({});return n.$on("start",t.start),n.$on("design",t.design),{c(){n.$$.fragment.c()},m(t,a){ot(n,t,a),e=!0},i(t){e||(Z(n.$$.fragment,t),e=!0)},o(t){tt(n.$$.fragment,t),e=!1},d(t){it(n,t)}}}function Ie(t){var e,n=new Se({});return n.$on("end",t.end),{c(){n.$$.fragment.c()},m(t,a){ot(n,t,a),e=!0},i(t){e||(Z(n.$$.fragment,t),e=!0)},o(t){tt(n.$$.fragment,t),e=!1},d(t){it(n,t)}}}function Te(t){var e,n=new xe({});return n.$on("end",t.end),{c(){n.$$.fragment.c()},m(t,a){ot(n,t,a),e=!0},i(t){e||(Z(n.$$.fragment,t),e=!0)},o(t){tt(n.$$.fragment,t),e=!1},d(t){it(n,t)}}}function ze(t){var e,n,a,r,o,i,s=[Te,Ie,Ce],c=[];function l(t){return t.playing?0:t.designing?1:2}e=l(t),n=c[e]=s[e](t);var d=new kt({props:{playing:t.playing,designing:t.designing}});d.$on("end",t.end);var h=new Wt({props:{random:!0}});return{c(){n.c(),a=w(),d.$$.fragment.c(),r=w(),o=y("div"),h.$$.fragment.c(),E(o,"class","background svelte-135avyh")},m(t,n){c[e].m(t,n),_(t,a,n),ot(d,t,n),_(t,r,n),_(t,o,n),ot(h,o,null),i=!0},p(t,r){var o=e;(e=l(r))!==o&&(Q(),tt(c[o],1,1,()=>{c[o]=null}),V(),(n=c[e])||(n=c[e]=s[e](r)).c(),Z(n,1),n.m(a.parentNode,a));var i={};t.playing&&(i.playing=r.playing),t.designing&&(i.designing=r.designing),d.$set(i)},i(t){i||(Z(n),Z(d.$$.fragment,t),Z(h.$$.fragment,t),i=!0)},o(t){tt(n),tt(d.$$.fragment,t),tt(h.$$.fragment,t),i=!1},d(t){c[e].d(t),t&&v(a),it(d,t),t&&(v(r),v(o)),it(h)}}}function Ae(t,e,n){let a="/play"===window.location.pathname,r="/design"===window.location.pathname;return{playing:a,designing:r,design:()=>{n("designing",r=!0),history.pushState({page:1},"","/design")},start:()=>{n("playing",a=!0),history.pushState({page:1},"","/play")},end:()=>{n("playing",a=!1),n("designing",r=!1),history.pushState({page:1},"","/")}}}return new class extends lt{constructor(t){super(),ct(this,t,Ae,ze,s,[])}}({target:document.body,props:{name:"stage"}})}();

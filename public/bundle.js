var app=function(){"use strict";function t(){}const e=t=>t;function a(t,e){for(const a in e)t[a]=e[a];return t}function n(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(n)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e,a){const n=e.subscribe(a);t.$$.on_destroy.push(n.unsubscribe?()=>n.unsubscribe():n)}function l(t,e,n){return t[1]?a({},a(e.$$scope.ctx,t[1](n?n(e):{}))):e.$$scope.ctx}let d="undefined"!=typeof window?()=>window.performance.now():()=>Date.now(),h=t=>requestAnimationFrame(t);const u=new Set;let g,f=!1;function m(){u.forEach(t=>{t[0](d())||(u.delete(t),t[1]())}),(f=u.size>0)&&h(m)}function $(t){let e;return f||(f=!0,h(m)),{promise:new Promise(a=>{u.add(e=[t,a])}),abort(){u.delete(e)}}}function p(t,e){t.appendChild(e)}function _(t,e,a){t.insertBefore(e,a||null)}function v(t){t.parentNode.removeChild(t)}function y(t,e){for(let a=0;a<t.length;a+=1)t[a]&&t[a].d(e)}function k(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function b(){return w(" ")}function x(){return w("")}function M(t,e,a,n){return t.addEventListener(e,a,n),()=>t.removeEventListener(e,a,n)}function j(t,e,a){null==a?t.removeAttribute(e):t.setAttribute(e,a)}function E(t,e){e=""+e,t.data!==e&&(t.data=e)}function S(t,e,a){t.style.setProperty(e,a)}function z(t,e,a){t.classList[a?"add":"remove"](e)}function C(t,e){const a=document.createEvent("CustomEvent");return a.initCustomEvent(t,!1,!1,e),a}let I,T=0,A={};function R(t,e){t.style.animation=(t.style.animation||"").split(", ").filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")).join(", "),e&&!--T&&h(()=>{if(T)return;let t=g.cssRules.length;for(;t--;)g.deleteRule(t);A={}})}function O(t){I=t}function L(t){(function(){if(!I)throw new Error("Function called outside component initialization");return I})().$$.on_mount.push(t)}function N(){const t=I;return(e,a)=>{const n=t.$$.callbacks[e];if(n){const r=C(e,a);n.slice().forEach(e=>{e.call(t,r)})}}}const P=[],D=[],U=[],W=[],B=Promise.resolve();let H,F=!1;function K(t){U.push(t)}function Y(){const t=new Set;do{for(;P.length;){const t=P.shift();O(t),q(t.$$)}for(;D.length;)D.pop()();for(let e=0;e<U.length;e+=1){const a=U[e];t.has(a)||(a(),t.add(a))}U.length=0}while(P.length);for(;W.length;)W.pop()();F=!1}function q(t){t.fragment&&(t.update(t.dirty),o(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(K))}function G(t,e,a){t.dispatchEvent(C(`${e?"intro":"outro"}${a}`))}const X=new Set;let J;function Q(){J={remaining:0,callbacks:[]}}function V(){J.remaining||o(J.callbacks)}function Z(t,e){t&&t.i&&(X.delete(t),t.i(e))}function tt(t,e,a,n){if(t&&t.o){if(X.has(t))return;X.add(t),J.callbacks.push(()=>{X.delete(t),n&&(a&&t.d(1),n())}),t.o(e)}}function et(a,n,r){let s,c=n(a,r),l=!0;const h=J;function u(){const{delay:n=0,duration:r=300,easing:i=e,tick:u=t,css:f}=c;f&&(s=function(t,e,a,n,r,o,i,s=0){const c=16.666/n;let l="{\n";for(let t=0;t<=1;t+=c){const n=e+(a-e)*o(t);l+=100*t+`%{${i(n,1-n)}}\n`}const d=l+`100% {${i(a,1-a)}}\n}`,h=`__svelte_${function(t){let e=5381,a=t.length;for(;a--;)e=(e<<5)-e^t.charCodeAt(a);return e>>>0}(d)}_${s}`;if(!A[h]){if(!g){const t=k("style");document.head.appendChild(t),g=t.sheet}A[h]=!0,g.insertRule(`@keyframes ${h} ${d}`,g.cssRules.length)}const u=t.style.animation||"";return t.style.animation=`${u?`${u}, `:""}${h} ${n}ms linear ${r}ms 1 both`,T+=1,h}(a,1,0,r,n,i,f));const m=d()+n,p=m+r;K(()=>G(a,!1,"start")),$(t=>{if(l){if(t>=p)return u(0,1),G(a,!1,"end"),--h.remaining||o(h.callbacks),!1;if(t>=m){const e=i((t-m)/r);u(1-e,e)}}return l})}return h.remaining+=1,i(c)?(H||(H=Promise.resolve()).then(()=>{H=null}),H).then(()=>{c=c(),u()}):u(),{end(t){t&&c.tick&&c.tick(1,0),l&&(s&&R(a,s),l=!1)}}}const at="undefined"!=typeof window?window:global;function nt(t,e){tt(t,1,1,()=>{e.delete(t.key)})}function rt(t,e){const a={},n={},r={$$scope:1};let o=t.length;for(;o--;){const i=t[o],s=e[o];if(s){for(const t in i)t in s||(n[t]=1);for(const t in s)r[t]||(a[t]=s[t],r[t]=1);t[o]=s}else for(const t in i)r[t]=1}for(const t in n)t in a||(a[t]=void 0);return a}function ot(t){let e;const a=t.subscribe(t=>e=t);return a.unsubscribe?a.unsubscribe():a(),e}function it(t,e,a){const{fragment:r,on_mount:s,on_destroy:c,after_update:l}=t.$$;r.m(e,a),K(()=>{const e=s.map(n).filter(i);c?c.push(...e):o(e),t.$$.on_mount=[]}),l.forEach(K)}function st(t,e){t.$$.fragment&&(o(t.$$.on_destroy),t.$$.fragment.d(e),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function ct(t,e){t.$$.dirty||(P.push(t),F||(F=!0,B.then(Y)),t.$$.dirty=r()),t.$$.dirty[e]=!0}function lt(e,a,n,i,s,c){const l=I;O(e);const d=a.props||{},h=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:s,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:r(),dirty:null};let u=!1;var g;h.ctx=n?n(e,d,(t,a)=>{h.ctx&&s(h.ctx[t],h.ctx[t]=a)&&(h.bound[t]&&h.bound[t](a),u&&ct(e,t))}):d,h.update(),u=!0,o(h.before_update),h.fragment=i(h.ctx),a.target&&(a.hydrate?h.fragment.l((g=a.target,Array.from(g.childNodes))):h.fragment.c(),a.intro&&Z(e.$$.fragment),it(e,a.target,a.anchor),Y()),O(l)}class dt{$destroy(){st(this,1),this.$destroy=t}$on(t,e){const a=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return a.push(e),()=>{const t=a.indexOf(e);-1!==t&&a.splice(t,1)}}$set(){}}function ht(t){const e=t-1;return e*e*e+1}function ut(t,{delay:e=0,duration:a=400}){const n=+getComputedStyle(t).opacity;return{delay:e,duration:a,css:t=>`opacity: ${t*n}`}}function gt(t,{delay:e=0,duration:a=400,easing:n=ht,x:r=0,y:o=0,opacity:i=0}){const s=getComputedStyle(t),c=+s.opacity,l="none"===s.transform?"":s.transform,d=c*(1-i);return{delay:e,duration:a,easing:n,css:(t,e)=>`\n\t\t\ttransform: ${l} translate(${(1-t)*r}px, ${(1-t)*o}px);\n\t\t\topacity: ${c-d*e}`}}function ft(a){var n,r,i,s,c,l,d,h,u,g,f,m,$,y,w,x;return{c(){n=k("div"),(r=k("h1")).textContent="EarthRock",i=b(),(s=k("h2")).textContent="The Uncollectable Card Game",c=b(),l=k("div"),(d=k("button")).textContent="START",h=b(),(u=k("button")).textContent="DESIGN",g=b(),(f=k("button")).textContent="DISCORD",m=b(),($=k("div")).textContent="We don't use cookies or store anything about you server side.",j(r,"class","title svelte-pb2muw"),j(s,"class","desc svelte-pb2muw"),j(d,"class","svelte-pb2muw"),j(u,"class","svelte-pb2muw"),j(f,"class","svelte-pb2muw"),j(l,"class","menu svelte-pb2muw"),j($,"class","notice svelte-pb2muw"),j(n,"class","intro svelte-pb2muw"),x=[M(d,"click",a.click_handler),M(u,"click",a.click_handler_1),M(f,"click",mt)]},m(t,e){_(t,n,e),p(n,r),p(n,i),p(n,s),p(n,c),p(n,l),p(l,d),p(l,h),p(l,u),p(l,g),p(l,f),p(n,m),p(n,$),w=!0},p:t,i(t){w||(y&&y.end(1),w=!0)},o(t){y=et(n,gt,{delay:100,duration:1e3,x:0,y:4e3,opacity:0,easing:e}),w=!1},d(t){t&&(v(n),y&&y.end()),o(x)}}}function mt(){return window.open("https://discord.gg/HnvRaKS","_blank")}function $t(t){const e=N();return{dispatch:e,click_handler:function(){return e("start")},click_handler_1:function(){return e("design")}}}class pt extends dt{constructor(t){super(),lt(this,t,$t,ft,s,[])}}window.location.host;function _t(t){var e,a;return{c(){(e=k("div")).textContent="X",j(e,"class","svelte-1uluz44"),a=M(e,"click",t.click_handler)},m(t,a){_(t,e,a)},d(t){t&&v(e),a()}}}function vt(e){var a,n,r,o,i,s=e.audo_playing?"<>":">",c=(e.playing||e.designing)&&_t(e);return{c(){a=k("div"),n=k("div"),r=w(s),o=b(),c&&c.c(),j(n,"class","svelte-1uluz44"),j(a,"class","tools svelte-1uluz44"),i=M(n,"click",e.toggle)},m(t,e){_(t,a,e),p(a,n),p(n,r),p(a,o),c&&c.m(a,null)},p(t,e){t.audo_playing&&s!==(s=e.audo_playing?"<>":">")&&E(r,s),e.playing||e.designing?c||((c=_t(e)).c(),c.m(a,null)):c&&(c.d(1),c=null)},i:t,o:t,d(t){t&&v(a),c&&c.d(),i()}}}function yt(t,e,a){let{playing:n=!1,designing:r=!1}=e;const o=N(),i=new Audio("/music/earthrock-final-theme.mp3");i.loop=!0,i.volume=.5;let s=!1;return t.$set=(t=>{"playing"in t&&a("playing",n=t.playing),"designing"in t&&a("designing",r=t.designing)}),{playing:n,designing:r,dispatch:o,audo_playing:s,toggle:()=>{s?i.pause():i.play(),a("audo_playing",s=!s)},click_handler:function(){return o("end")}}}class kt extends dt{constructor(t){super(),lt(this,t,yt,vt,s,["playing","designing"])}}function wt(e,a=t){let n;const r=[];function o(t){if(s(e,t)){if(e=t,!n)return;r.forEach(t=>t[1]()),r.forEach(t=>t[0](e))}}return{set:o,update:function(t){o(t(e))},subscribe:function(i,s=t){const c=[i,s];return r.push(c),1===r.length&&(n=a(o)||t),i(e),()=>{const t=r.indexOf(c);-1!==t&&r.splice(t,1),0===r.length&&(n(),n=null)}}}}const bt=wt(1),xt=()=>{const[t,e]=[window.innerWidth,window.innerHeight],a=t>e?e:t;bt.set(a/1e3)};window.addEventListener("resize",xt),xt();const Mt=wt(1);function jt(t){var e,n;const r=t.$$slots.default,o=function(t,e,a){if(t){const n=l(t,e,a);return t[0](n)}}(r,t,null);return{c(){e=k("div"),o&&o.c(),j(e,"class","spatial svelte-12mwy3p"),j(e,"style",t.style)},l(t){o&&o.l(div_nodes)},m(t,a){_(t,e,a),o&&o.m(e,null),n=!0},p(t,i){o&&o.p&&t.$$scope&&o.p(function(t,e,n,r){return t[1]?a({},a(e.$$scope.changed||{},t[1](r?r(n):{}))):e.$$scope.changed||{}}(r,i,t,null),l(r,i,null)),n&&!t.style||j(e,"style",i.style)},i(t){n||(Z(o,t),n=!0)},o(t){tt(o,t),n=!1},d(t){t&&v(e),o&&o.d(t)}}}function Et(t,e,a){let n;c(t,bt,t=>{a("$scaling",n=t)});let r,o,i,s,l,{position:d=[0,0],anchor:h=[50,50],bias:u=[50,50],area:g=[1,1],scale:f=1,rotate:m=0,autoscale:$=!0,zIndex:p=0}=e,{$$slots:_={},$$scope:v}=e;return t.$set=(t=>{"position"in t&&a("position",d=t.position),"anchor"in t&&a("anchor",h=t.anchor),"bias"in t&&a("bias",u=t.bias),"area"in t&&a("area",g=t.area),"scale"in t&&a("scale",f=t.scale),"rotate"in t&&a("rotate",m=t.rotate),"autoscale"in t&&a("autoscale",$=t.autoscale),"zIndex"in t&&a("zIndex",p=t.zIndex),"$$scope"in t&&a("$$scope",v=t.$$scope)}),t.$$.update=((t={anchor:1,bias:1,area:1,autoscale:1,scale:1,$scaling:1,position:1,offset:1,rotate:1,tru_scale:1,zIndex:1,tru_zIndex:1,transform:1})=>{t.anchor&&a("anchor",h=[h[0]<=50?`left: ${h[0]}%;`:`right: ${100-h[0]}%;`,h[1]<=50?`top: ${h[1]}%;`:`bottom: ${100-h[1]}%;`].join(" ")),(t.bias||t.area||t.anchor)&&a("offset",r=[.01*u[0]*g[0]/2*(h[0]<=50?-1:1),.01*u[1]*g[1]/2*(h[1]<=50?-1:1)]),(t.autoscale||t.scale||t.$scaling)&&a("tru_scale",o=$?f*n:f),(t.position||t.offset||t.rotate||t.tru_scale)&&a("transform",i=`transform: translate(${d[0]+r[0]}px, ${d[1]+r[1]}px) rotate(${m}deg) scale(${o});`),(t.scale||t.zIndex)&&a("tru_zIndex",s=`z-index: ${Math.max(1,Math.round(100*f+p))};`),(t.tru_zIndex||t.anchor||t.transform)&&a("style",l=[s,h,i].join(" "))}),{position:d,anchor:h,bias:u,area:g,scale:f,rotate:m,autoscale:$,zIndex:p,style:l,$$slots:_,$$scope:v}}setInterval(()=>{Mt.set(ot(Mt)+1)},100);class St extends dt{constructor(t){super(),lt(this,t,Et,jt,s,["position","anchor","bias","area","scale","rotate","autoscale","zIndex"])}}const zt=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}),Ct=t=>({id:zt(),data:It(25),...t}),It=t=>{const e=[];for(let a=0;a<t;a++)e.push(Math.floor(1024*Math.random()));return e.join(" ")},Tt=()=>({id:zt(),name:It(5),image:It(25),cost:Math.floor(10*Math.random()),effect1:It(3),effect2:It(3),effect3:It(3)}),At=t=>{const e=[];for(let a=0;a<t;a++)e.push(Tt());return e},Rt={faked:!1,tasks:{STATE:new Set},state:{away_deck:wt([]),away_hand:wt([]),away_discard:wt([]),away_field:wt([]),away_back:wt(""),home_deck:wt([]),home_hand:wt([]),home_discard:wt([]),home_field:wt([]),home_back:wt(""),home_gems:wt(0),away_gems:wt(0),home_hearts:wt(0),away_hearts:wt(0),home_tokens:wt([]),away_tokens:wt([])},server_fake:()=>{Rt.faked=(t=>{const e={away_deck:At(30),home_deck:At(30),away_hand:At(5),home_hand:At(5),away_back:It(15),home_back:It(15),home_discard:[],home_gems:Math.floor(10*Math.random()),home_hearts:Math.floor(6*Math.random()),away_hearts:Math.floor(6*Math.random()),away_discard:[],away_gems:Math.floor(10*Math.random()),away_tokens:[Ct({king:!0})]};e.home_tokens=[Ct({king:!0,data:e.home_back,color:90,stats:{gems:e.home_gems,hearts:e.home_hearts}})];const a={PLAY:({id:n})=>{const{home_hand:r,home_discard:o}=e;for(let i=0;i<e.home_hand.length;i++){const s=e.home_hand[i];if(s.id===n)return r.splice(i,1),o.unshift(s),t.do({task:"STATE",data:{home_hand:r,home_discard:o}}),a.SUCCESS()}},DRAW:()=>{const{home_deck:n,home_hand:r}=e;return r.push(n.pop()),t.do({task:"STATE",data:{home_deck:n,home_hand:r}}),a.SUCCESS()},SUCCESS:()=>({code:200,text:"SuCcEsS"}),ERROR_404:()=>({code:404,text:"TaSk NoT FoUnD"})};return t.do({task:"STATE",data:e}),({task:t,data:e})=>a[t]?a[t](e):a.ERROR_404()})(Rt)},do:({task:t,data:e})=>{void 0!==Rt.tasks[t]?Rt.tasks[t].forEach(t=>t(e)):console.error(`Tried to call an undefined task ${t}`)},do_server:async t=>{if(Rt.faked)return Rt.faked(t);return(await fetch("/do",{method:"POST",mode:"same-origin",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()},when:(t,e)=>{if(void 0!==Rt.tasks[t])return Rt.tasks[t].add(e),()=>{Rt.tasks[t].delete(e)};console.error(`Tried to wait for an undefined task ${t}`)}};Rt.when("STATE",t=>Object.entries(t).forEach(([t,e])=>Rt.state[t].set(e)));const Ot=wt([0,0]),Lt=[0,0];window.addEventListener("mousemove",t=>{Lt[0]=t.clientX,Lt[1]=t.clientY,Lt[0]===ot(Ot)[0]&&Lt[1]===ot(Ot)[1]||Ot.set([...Lt])});const Nt=new Promise(t=>{const e=new Image;e.src="/sheets/default.png",e.onload=(()=>{const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const n=a.getContext("2d");n.drawImage(e,0,0),t({ctx:n,canvas:a})})}),Pt=new Map,Dt=(t,e)=>Math.floor(Math.random()*(Math.abs(t)+Math.abs(e))-Math.abs(t));var Ut=async({width:t,height:e,data:a,random:n=!1})=>{const{canvas:r}=await Nt,o=`${t}:${e}:${a}`;if(!n&&Pt.has(o))return Pt.get(o);const i=document.createElement("canvas"),s=i.getContext("2d");if(i.width=16*t,i.height=16*e,n){let a,n,o,i;for(let c=0;c<t;c++)for(let t=0;t<e;t++)a=16*c,n=16*t,o=17*Dt(0,32),i=17*Dt(0,32),s.drawImage(r,o,i,16,16,a,n,16,16)}else if(a.length>0){let e,n;a.split(" ").forEach((a,o)=>{e=o%t,n=Math.floor(o/t);const i=parseInt(a,10),c=i%32,l=Math.floor(i/32),d=16*e,h=16*n,u=17*c,g=17*l;s.drawImage(r,u,g,16,16,d,h,16,16)})}const c=i.toDataURL("image/png");return n||Pt.set(KeyboardEvent,c),c};function Wt(e){var a;return{c(){j(a=k("img"),"class","tileset svelte-1bdmb53"),j(a,"alt","tileset image")},m(t,n){_(t,a,n),e.img_binding(a)},p:t,i:t,o:t,d(t){t&&v(a),e.img_binding(null)}}}function Bt(t,e,a){let n,{data:r="",width:o=10,height:i=7,spacing:s=0,random:c=!1}=e;return L(async()=>{n.src=await Ut({width:o,height:i,data:r,random:c}),a("image",n)}),t.$set=(t=>{"data"in t&&a("data",r=t.data),"width"in t&&a("width",o=t.width),"height"in t&&a("height",i=t.height),"spacing"in t&&a("spacing",s=t.spacing),"random"in t&&a("random",c=t.random)}),{data:r,width:o,height:i,spacing:s,random:c,image:n,img_binding:function(t){D[t?"unshift":"push"](()=>{a("image",n=t)})}}}class Ht extends dt{constructor(t){super(),lt(this,t,Bt,Wt,s,["data","width","height","spacing","random"])}}function Ft(t,e,a){const n=Object.create(t);return n.line=e[a],n}function Kt(t){var e,a,n,r,o,i,s;return{c(){e=k("div"),a=b(),n=k("div"),r=b(),o=k("div"),i=b(),s=k("div"),j(e,"class","border border-top svelte-w6sj1a"),j(n,"class","border border-bottom svelte-w6sj1a"),j(o,"class","border border-left svelte-w6sj1a"),j(s,"class","border border-right svelte-w6sj1a")},m(t,c){_(t,e,c),_(t,a,c),_(t,n,c),_(t,r,c),_(t,o,c),_(t,i,c),_(t,s,c)},d(t){t&&(v(e),v(a),v(n),v(r),v(o),v(i),v(s))}}}function Yt(t){var e,a,n,r,o,i,s,c,l,d,h,u,g,f=t.vitals[0],m=t.vitals[1],$=new Ht({props:{width:1,height:1,random:!0}}),y=new Ht({props:{width:1,height:1,random:!0}}),x=new Ht({props:{width:1,height:1,random:!0}});return{c(){e=k("div"),a=k("div"),n=k("div"),$.$$.fragment.c(),r=b(),o=k("div"),i=k("div"),y.$$.fragment.c(),s=b(),c=w(f),l=b(),d=k("div"),x.$$.fragment.c(),h=b(),u=w(m),j(n,"class","tile svelte-w6sj1a"),j(a,"class","icon svelte-w6sj1a"),j(i,"class","tile svelte-w6sj1a"),j(d,"class","tile svelte-w6sj1a"),j(o,"class","vitals svelte-w6sj1a"),j(e,"class","line svelte-w6sj1a")},m(t,f){_(t,e,f),p(e,a),p(a,n),it($,n,null),p(e,r),p(e,o),p(o,i),it(y,i,null),p(o,s),p(o,c),p(o,l),p(o,d),it(x,d,null),p(o,h),p(o,u),g=!0},p(t,e){g&&!t.vitals||f===(f=e.vitals[0])||E(c,f),g&&!t.vitals||m===(m=e.vitals[1])||E(u,m)},i(t){g||(Z($.$$.fragment,t),Z(y.$$.fragment,t),Z(x.$$.fragment,t),g=!0)},o(t){tt($.$$.fragment,t),tt(y.$$.fragment,t),tt(x.$$.fragment,t),g=!1},d(t){t&&v(e),st($),st(y),st(x)}}}function qt(t){for(var e,a,n,r,i,s,c,l,d,h,u,g,f,m,$,x,C,I,T,A,R,O,L,N=t.borders&&Kt(),P=new Ht({props:{width:3,height:5,data:t.back}}),D=new Ht({props:{data:t.name,width:5,height:1}}),U=new Ht({props:{width:5,height:5,data:t.image}}),W=t.lines,B=[],H=0;H<W.length;H+=1)B[H]=Yt(Ft(t,W,H));const F=t=>tt(B[t],1,1,()=>{B[t]=null});return{c(){e=k("div"),a=k("div"),N&&N.c(),n=b(),r=k("div"),P.$$.fragment.c(),i=b(),s=k("div"),c=k("div"),l=k("div"),D.$$.fragment.c(),d=b(),h=k("div"),u=b(),g=k("div"),f=w(t.cost),m=b(),$=k("div"),U.$$.fragment.c(),x=b(),C=k("div");for(var o=0;o<B.length;o+=1)B[o].c();I=b(),T=k("div"),A=b(),(R=k("div")).textContent="E A R T H R O C K",j(r,"class","back svelte-w6sj1a"),S(r,"filter","sepia(1) hue-rotate("+t.color+"deg) brightness("+(t.fade?.5:1)+")"),j(l,"class","title svelte-w6sj1a"),j(h,"class","flex svelte-w6sj1a"),j(g,"class","cost svelte-w6sj1a"),j(c,"class","header svelte-w6sj1a"),j($,"class","image svelte-w6sj1a"),j(T,"class","flex svelte-w6sj1a"),j(C,"class","details svelte-w6sj1a"),j(R,"class","earthrock svelte-w6sj1a"),j(s,"class","front svelte-w6sj1a"),j(a,"class","contents svelte-w6sj1a"),z(a,"flip",t.flip),j(e,"style",t.style),j(e,"class","card svelte-w6sj1a"),z(e,"fade",t.fade),z(e,"dragging",t.dragging),L=[M(r,"click",t.beginInteract),M(s,"mousedown",t.beginInteract),M(e,"mouseenter",t.delay_hover.on),M(e,"mouseleave",t.delay_hover.off)]},m(t,o){_(t,e,o),p(e,a),N&&N.m(a,null),p(a,n),p(a,r),it(P,r,null),p(a,i),p(a,s),p(s,c),p(c,l),it(D,l,null),p(c,d),p(c,h),p(c,u),p(c,g),p(g,f),p(s,m),p(s,$),it(U,$,null),p(s,x),p(s,C);for(var v=0;v<B.length;v+=1)B[v].m(C,null);p(C,I),p(C,T),p(s,A),p(s,R),O=!0},p(t,o){o.borders?N||((N=Kt()).c(),N.m(a,n)):N&&(N.d(1),N=null);var i={};t.back&&(i.data=o.back),P.$set(i),(!O||t.color||t.fade)&&S(r,"filter","sepia(1) hue-rotate("+o.color+"deg) brightness("+(o.fade?.5:1)+")");var s={};t.name&&(s.data=o.name),D.$set(s),O&&!t.cost||E(f,o.cost);var c={};if(t.image&&(c.data=o.image),U.$set(c),t.vitals||t.lines){W=o.lines;for(var l=0;l<W.length;l+=1){const e=Ft(o,W,l);B[l]?(B[l].p(t,e),Z(B[l],1)):(B[l]=Yt(e),B[l].c(),Z(B[l],1),B[l].m(C,I))}for(Q(),l=W.length;l<B.length;l+=1)F(l);V()}t.flip&&z(a,"flip",o.flip),O&&!t.style||j(e,"style",o.style),t.fade&&z(e,"fade",o.fade),t.dragging&&z(e,"dragging",o.dragging)},i(t){if(!O){Z(P.$$.fragment,t),Z(D.$$.fragment,t),Z(U.$$.fragment,t);for(var e=0;e<W.length;e+=1)Z(B[e]);O=!0}},o(t){tt(P.$$.fragment,t),tt(D.$$.fragment,t),tt(U.$$.fragment,t),B=B.filter(Boolean);for(let t=0;t<B.length;t+=1)tt(B[t]);O=!1},d(t){t&&v(e),N&&N.d(),st(P),st(D),st(U),y(B,t),o(L)}}}const Gt=.5;function Xt(t,e,a){let n;c(t,Ot,t=>{a("$mouse_pos",n=t)});const r=N();let{deck:o="",id:i="foobar",cost:s=0,name:l="16 55 33 44 55",image:d="",effect1:h="",effect2:u="",effect3:g="",back:f="",borders:m=!1,vitals:$=[1,1],invert:p=!1,interact:_=!0,drag:v=!1,position:y=[0,0],position_raw:k=!1,rotation:w=0,scale:b=1,color:x=90,card:M={},young:j=!0,fade:E=!1,anchor:S=[50,50]}=e;const z=[h,u,g];let C=!0;L(()=>{setTimeout(()=>{a("young",j=!1),a("flip",C=!_)},250)});let I=!1;const T=(({time:t=250,on:e=(()=>{}),off:a=(()=>{})})=>{let n;return{on:()=>{_&&(n&&clearTimeout(n),e())},off:()=>{_&&(n&&clearTimeout(n),n=setTimeout(()=>{n=0,a()},t))}}})({time:100,on:()=>{a("hover",H=!0)},off:()=>{const t=H=!1;return a("hover",H),t}});let A,R,O,P,D,U,W,B,H=!1;return t.$set=(t=>{"deck"in t&&a("deck",o=t.deck),"id"in t&&a("id",i=t.id),"cost"in t&&a("cost",s=t.cost),"name"in t&&a("name",l=t.name),"image"in t&&a("image",d=t.image),"effect1"in t&&a("effect1",h=t.effect1),"effect2"in t&&a("effect2",u=t.effect2),"effect3"in t&&a("effect3",g=t.effect3),"back"in t&&a("back",f=t.back),"borders"in t&&a("borders",m=t.borders),"vitals"in t&&a("vitals",$=t.vitals),"invert"in t&&a("invert",p=t.invert),"interact"in t&&a("interact",_=t.interact),"drag"in t&&a("drag",v=t.drag),"position"in t&&a("position",y=t.position),"position_raw"in t&&a("position_raw",k=t.position_raw),"rotation"in t&&a("rotation",w=t.rotation),"scale"in t&&a("scale",b=t.scale),"color"in t&&a("color",x=t.color),"card"in t&&a("card",M=t.card),"young"in t&&a("young",j=t.young),"fade"in t&&a("fade",E=t.fade),"anchor"in t&&a("anchor",S=t.anchor)}),t.$$.update=((t={hover:1,scale:1,rotation:1,invert:1,dragging:1,anchor:1,tru_anchor:1,$mouse_pos:1,tru_width:1,tru_height:1,position_raw:1,tru_rotation:1,tru_scale:1,position:1,tru_invert:1,transforms:1})=>{(t.hover||t.scale)&&a("tru_scale",A=H?1.168*b:b),(t.hover||t.rotation)&&a("tru_rotation",R=H?0:w),t.invert&&a("tru_invert",O=p?-1:1),(t.dragging||t.anchor)&&a("tru_anchor",P=I?[50,50]:S),t.tru_anchor&&a("tru_width",D=250*(P[0]<=50?-1:1)),t.tru_anchor&&a("tru_height",U=400*(P[1]<=50?-1:1)),(t.dragging||t.$mouse_pos||t.tru_width||t.tru_height||t.position_raw||t.tru_rotation||t.tru_scale||t.position||t.hover||t.tru_invert)&&a("transforms",W=I?`transform: translate(${n[0]-window.innerWidth/2+D}px, ${n[1]-window.innerHeight/2+U}px) rotate(0deg) scale(${Gt});z-index: 1000`:k?`transform: translate(${k[0]-window.innerWidth/2-D}px, ${k[1]-window.innerHeight/2-U}px) rotate(${R}deg) scale(${A}) ; z-index: ${Math.round(100*A)}`:`transform: translate(${5*y[0]+D}px, ${8*(y[1]+(H?-5*O:0))+U}px) rotate(${R}deg) scale(${A}) ; z-index: ${Math.round(100*A)+100}`),(t.transforms||t.tru_anchor)&&a("style",B=[W,P[0]<=50?`left: ${P[0]}%`:`right: ${100-P[0]}%`,P[1]<=50?`top: ${P[1]}%`:`bottom: ${100-P[1]}%`].join(";"))}),{deck:o,id:i,cost:s,name:l,image:d,effect1:h,effect2:u,effect3:g,back:f,borders:m,vitals:$,invert:p,interact:_,drag:v,position:y,position_raw:k,rotation:w,scale:b,color:x,card:M,young:j,fade:E,anchor:S,lines:z,flip:C,dragging:I,beginInteract:()=>{if(r("click",M),v){a("dragging",I=!0);const t=window.addEventListener("mouseup",()=>{r("dragend",M),a("dragging",I=!1),window.removeEventListener("mouseup",t)})}},delay_hover:T,style:B}}class Jt extends dt{constructor(t){super(),lt(this,t,Xt,qt,s,["deck","id","cost","name","image","effect1","effect2","effect3","back","borders","vitals","invert","interact","drag","position","position_raw","rotation","scale","color","card","young","fade","anchor"])}}function Qt(t,e,a){const n=Object.create(t);return n.card=e[a],n.index=a,n}function Vt(t){var e,n=[t.card,{scale:t.scale*t.$scaling},{invert:t.invert},{interact:t.interact},{color:t.color},{card:t.card},{drag:t.drag},{fade:t.fade},{anchor:t.anchor},{back:t.$back},{position:90===t.Math.abs(t.rotation)?[t.position[0],t.position[1]+t.tru_index(t.index)*t.tru_spread-t.tru_length/2*t.tru_spread]:[t.position[0]+t.tru_index(t.index)*t.tru_spread-t.tru_length/2*t.tru_spread,t.position[1]+(t.invert?-1:1)*t.Math.abs(t.tru_index(t.index)-t.tru_length/2)*t.spread_y]},{rotation:t.rotation+(t.tru_index(t.index)-t.tru_length/2)*t.tru_rotate*(t.invert?-1:1)+(t.invert?180:0)}];let r={};for(var o=0;o<n.length;o+=1)r=a(r,n[o]);var i=new Jt({props:r});return i.$on("dragend",t.dragend_handler),i.$on("click",t.click_handler),{c(){i.$$.fragment.c()},m(t,a){it(i,t,a),e=!0},p(t,e){var a=t.$cards||t.scale||t.$scaling||t.invert||t.interact||t.color||t.drag||t.fade||t.anchor||t.$back||t.Math||t.rotation||t.position||t.tru_index||t.tru_spread||t.tru_length||t.spread_y||t.tru_rotate?rt(n,[t.$cards&&e.card,(t.scale||t.$scaling)&&{scale:e.scale*e.$scaling},t.invert&&{invert:e.invert},t.interact&&{interact:e.interact},t.color&&{color:e.color},t.$cards&&{card:e.card},t.drag&&{drag:e.drag},t.fade&&{fade:e.fade},t.anchor&&{anchor:e.anchor},t.$back&&{back:e.$back},(t.Math||t.rotation||t.position||t.tru_index||t.$cards||t.tru_spread||t.tru_length||t.invert||t.spread_y)&&{position:90===e.Math.abs(e.rotation)?[e.position[0],e.position[1]+e.tru_index(e.index)*e.tru_spread-e.tru_length/2*e.tru_spread]:[e.position[0]+e.tru_index(e.index)*e.tru_spread-e.tru_length/2*e.tru_spread,e.position[1]+(e.invert?-1:1)*e.Math.abs(e.tru_index(e.index)-e.tru_length/2)*e.spread_y]},(t.rotation||t.tru_index||t.$cards||t.tru_length||t.tru_rotate||t.invert)&&{rotation:e.rotation+(e.tru_index(e.index)-e.tru_length/2)*e.tru_rotate*(e.invert?-1:1)+(e.invert?180:0)}]):{};i.$set(a)},i(t){e||(Z(i.$$.fragment,t),e=!0)},o(t){tt(i.$$.fragment,t),e=!1},d(t){st(i,t)}}}function Zt(t,e){var a,n,r,o=e.tru_index(e.index)<e.max&&Vt(e);return{key:t,first:null,c(){a=x(),o&&o.c(),n=x(),this.first=a},m(t,e){_(t,a,e),o&&o.m(t,e),_(t,n,e),r=!0},p(t,e){e.tru_index(e.index)<e.max?o?(o.p(t,e),Z(o,1)):((o=Vt(e)).c(),Z(o,1),o.m(n.parentNode,n)):o&&(Q(),tt(o,1,1,()=>{o=null}),V())},i(t){r||(Z(o),r=!0)},o(t){tt(o),r=!1},d(t){t&&v(a),o&&o.d(t),t&&v(n)}}}function te(t){var e,a,n=[],r=new Map,o=t.$cards;const i=t=>t.card.id;for(var s=0;s<o.length;s+=1){let e=Qt(t,o,s),a=i(e);r.set(a,n[s]=Zt(a,e))}return{c(){for(s=0;s<n.length;s+=1)n[s].c();e=x()},m(t,r){for(s=0;s<n.length;s+=1)n[s].m(t,r);_(t,e,r),a=!0},p(t,a){const o=a.$cards;Q(),n=function(t,e,a,n,r,o,i,s,c,l,d,h){let u=t.length,g=o.length,f=u;const m={};for(;f--;)m[t[f].key]=f;const $=[],p=new Map,_=new Map;for(f=g;f--;){const t=h(r,o,f),s=a(t);let c=i.get(s);c?n&&c.p(e,t):(c=l(s,t)).c(),p.set(s,$[f]=c),s in m&&_.set(s,Math.abs(f-m[s]))}const v=new Set,y=new Set;function k(t){Z(t,1),t.m(s,d),i.set(t.key,t),d=t.first,g--}for(;u&&g;){const e=$[g-1],a=t[u-1],n=e.key,r=a.key;e===a?(d=e.first,u--,g--):p.has(r)?!i.has(n)||v.has(n)?k(e):y.has(r)?u--:_.get(n)>_.get(r)?(y.add(n),k(e)):(v.add(r),u--):(c(a,i),u--)}for(;u--;){const e=t[u];p.has(e.key)||c(e,i)}for(;g;)k($[g-1]);return $}(n,t,i,1,a,o,r,e.parentNode,nt,Zt,e,Qt),V()},i(t){if(!a){for(var e=0;e<o.length;e+=1)Z(n[e]);a=!0}},o(t){for(s=0;s<n.length;s+=1)tt(n[s]);a=!1},d(t){for(s=0;s<n.length;s+=1)n[s].d(t);t&&v(e)}}}function ee(t,e,a){let n,r,o;c(t,bt,t=>{a("$scaling",r=t)});const i=N();let{cards:s=wt([]),max:l=10,position:d=[0,0],anchor:h=[50,50],invert:u=!1,fade:g=!1,drag:f=!1,reverse:m=!1,scale:$=1,spread:p=10,spread_y:_=1,interact:v=!0,rotate:y=3,rotation:k=0,color:w=90}=e;c(t,s,t=>{a("$cards",n=t)});let{back:b=wt("")}=e;c(t,b,t=>{a("$back",o=t)});let x,M,j,E;return t.$set=(t=>{"cards"in t&&a("cards",s=t.cards),"max"in t&&a("max",l=t.max),"position"in t&&a("position",d=t.position),"anchor"in t&&a("anchor",h=t.anchor),"invert"in t&&a("invert",u=t.invert),"fade"in t&&a("fade",g=t.fade),"drag"in t&&a("drag",f=t.drag),"reverse"in t&&a("reverse",m=t.reverse),"scale"in t&&a("scale",$=t.scale),"spread"in t&&a("spread",p=t.spread),"spread_y"in t&&a("spread_y",_=t.spread_y),"interact"in t&&a("interact",v=t.interact),"rotate"in t&&a("rotate",y=t.rotate),"rotation"in t&&a("rotation",k=t.rotation),"color"in t&&a("color",w=t.color),"back"in t&&a("back",b=t.back)}),t.$$.update=((t={$cards:1,max:1,tru_length:1,spread:1,x_factor:1,$scaling:1,rotate:1})=>{(t.$cards||t.max)&&a("tru_length",x=n.length>l?l:n.length),(t.tru_length||t.max)&&a("x_factor",M=Math.max(x/l,.5)),(t.spread||t.x_factor||t.$scaling)&&a("tru_spread",j=p/M*r),(t.rotate||t.x_factor)&&a("tru_rotate",E=y/M)}),{dispatch:i,cards:s,max:l,position:d,anchor:h,invert:u,fade:g,drag:f,reverse:m,scale:$,spread:p,spread_y:_,interact:v,rotate:y,rotation:k,color:w,back:b,tru_index:t=>m?n.length-t:t,tru_length:x,$cards:n,Math:Math,tru_spread:j,$scaling:r,tru_rotate:E,$back:o,dragend_handler:function({detail:t}){return i("dragend",t)},click_handler:function({detail:t}){return i("click",t)}}}class ae extends dt{constructor(t){super(),lt(this,t,ee,te,s,["cards","max","position","anchor","invert","fade","drag","reverse","scale","spread","spread_y","interact","rotate","rotation","color","back"])}}function ne(t){var e,a,n,r=new Ht({props:{data:(t.is_first?180:68).toString(),width:1,height:1}});return{c(){e=k("div"),r.$$.fragment.c(),j(e,"class","gem svelte-zkzcyd"),j(e,"style",a=`filter:hue-rotate(${t.hue}) brightness(${t.bright_default+.168*Math.sin(t.i)}) drop-shadow(0.5vh -0.5vw 0 rgba(0,0,0,0.25));`),z(e,"hover",re),z(e,"empty",t.empty)},m(t,a){_(t,e,a),it(r,e,null),n=!0},p(t,o){var i={};t.is_first&&(i.data=(o.is_first?180:68).toString()),r.$set(i),(!n||t.hue||t.bright_default||t.i)&&a!==(a=`filter:hue-rotate(${o.hue}) brightness(${o.bright_default+.168*Math.sin(o.i)}) drop-shadow(0.5vh -0.5vw 0 rgba(0,0,0,0.25));`)&&j(e,"style",a),t.hover&&z(e,"hover",re),t.empty&&z(e,"empty",o.empty)},i(t){n||(Z(r.$$.fragment,t),n=!0)},o(t){tt(r.$$.fragment,t),n=!1},d(t){t&&v(e),st(r)}}}let re=!1;function oe(t,e,a){let n,r,o,{empty:i=!1,i:s=0}=e;return t.$set=(t=>{"empty"in t&&a("empty",i=t.empty),"i"in t&&a("i",s=t.i)}),t.$$.update=((t={i:1,empty:1})=>{t.i&&a("is_first",n=s%9!=0),t.empty&&a("bright_default",r=i?.25:.75),t.empty&&a("hue",o=`${i?-90:90}deg`)}),{empty:i,i:s,is_first:n,bright_default:r,hue:o}}class ie extends dt{constructor(t){super(),lt(this,t,oe,ne,s,["empty","i"])}}function se(t){var e,a,n,r=new Ht({props:{data:"88",width:1,height:1}});return{c(){e=k("div"),r.$$.fragment.c(),j(e,"class","heart svelte-1tslrl5"),j(e,"style",a=`filter:sepia(1) hue-rotate(${t.hue}) brightness(${t.bright_default+.168*Math.sin(t.i)}) drop-shadow(0.5vh 0.5vw 0 rgba(0,0,0,0.25));`),z(e,"empty",t.empty)},m(t,a){_(t,e,a),it(r,e,null),n=!0},p(t,r){(!n||t.hue||t.bright_default||t.i)&&a!==(a=`filter:sepia(1) hue-rotate(${r.hue}) brightness(${r.bright_default+.168*Math.sin(r.i)}) drop-shadow(0.5vh 0.5vw 0 rgba(0,0,0,0.25));`)&&j(e,"style",a),t.empty&&z(e,"empty",r.empty)},i(t){n||(Z(r.$$.fragment,t),n=!0)},o(t){tt(r.$$.fragment,t),n=!1},d(t){t&&v(e),st(r)}}}function ce(t,e,a){let n,r,{empty:o=!1,i:i=0}=e;return t.$set=(t=>{"empty"in t&&a("empty",o=t.empty),"i"in t&&a("i",i=t.i)}),t.$$.update=((t={i:1,empty:1})=>{t.i,t.empty&&a("bright_default",n=o?0:.9)}),a("hue",r="230deg"),{empty:o,i:i,bright_default:n,hue:"230deg"}}class le extends dt{constructor(t){super(),lt(this,t,ce,se,s,["empty","i"])}}const{Object:de}=at;function he(t,e,a){const n=de.create(t);return n.name=e[a][0],n.data=e[a][1],n}function ue(t){var e,a,n,r,o=t.data;return{c(){e=k("div"),a=w(o),n=b(),j(e,"class",r=t.name+" svelte-4m8clz")},m(t,r){_(t,e,r),p(e,a),p(e,n)},p(t,n){t.stats_arr&&o!==(o=n.data)&&E(a,o),t.stats_arr&&r!==(r=n.name+" svelte-4m8clz")&&j(e,"class",r)},d(t){t&&v(e)}}}function ge(t){for(var e,a,n,r,o,i,s=t.stats_arr,c=[],l=0;l<s.length;l+=1)c[l]=ue(he(t,s,l));var d=new Ht({props:{width:t.grid[0],height:t.grid[1],data:t.data}}),h=new Ht({props:{width:t.grid[1],height:t.grid[0],data:t.data}});return{c(){e=k("div");for(var i=0;i<c.length;i+=1)c[i].c();a=b(),n=k("div"),d.$$.fragment.c(),r=b(),o=k("div"),h.$$.fragment.c(),j(e,"class","text svelte-4m8clz"),j(n,"class","token svelte-4m8clz"),j(n,"style",t.style),z(n,"king",t.king),j(o,"class","bg svelte-4m8clz")},m(t,s){_(t,e,s);for(var l=0;l<c.length;l+=1)c[l].m(e,null);_(t,a,s),_(t,n,s),it(d,n,null),_(t,r,s),_(t,o,s),it(h,o,null),i=!0},p(t,a){if(t.stats_arr){s=a.stats_arr;for(var r=0;r<s.length;r+=1){const n=he(a,s,r);c[r]?c[r].p(t,n):(c[r]=ue(n),c[r].c(),c[r].m(e,null))}for(;r<c.length;r+=1)c[r].d(1);c.length=s.length}var o={};t.grid&&(o.width=a.grid[0]),t.grid&&(o.height=a.grid[1]),t.data&&(o.data=a.data),d.$set(o),i&&!t.style||j(n,"style",a.style),t.king&&z(n,"king",a.king);var l={};t.grid&&(l.width=a.grid[1]),t.grid&&(l.height=a.grid[0]),t.data&&(l.data=a.data),h.$set(l)},i(t){i||(Z(d.$$.fragment,t),Z(h.$$.fragment,t),i=!0)},o(t){tt(d.$$.fragment,t),tt(h.$$.fragment,t),i=!1},d(t){t&&v(e),y(c,t),t&&(v(a),v(n)),st(d),t&&(v(r),v(o)),st(h)}}}function fe(t,e,a){let n,r,o,{king:i=!1,data:s="",color:c=0,stats:l={}}=e;return t.$set=(t=>{"king"in t&&a("king",i=t.king),"data"in t&&a("data",s=t.data),"color"in t&&a("color",c=t.color),"stats"in t&&a("stats",l=t.stats)}),t.$$.update=((t={king:1,color:1,stats:1})=>{t.king&&a("grid",n=i?[3,5]:[5,5]),t.color&&a("style",r=`filter:sepia(1) hue-rotate(${c}deg) drop-shadow(0px 0px 1rem rgba(0, 255, 0, 0.2));`),t.stats&&a("stats_arr",o=Object.entries(l))}),{king:i,data:s,color:c,stats:l,grid:n,style:r,stats_arr:o}}class me extends dt{constructor(t){super(),lt(this,t,fe,ge,s,["king","data","color","stats"])}}const $e=({max:t=9,radius:e=50,offset:a=0,wobble:n=[.5,20]}=!1)=>({i:a,scale:r})=>{const o=a/t*2*Math.PI,i=r*(e+Math.sin(a+n[0])*n[1]);return[i*Math.cos(o),i*Math.sin(o)]};function pe(t,e,a){const n=Object.create(t);return n.item=e[a],n.i=a,n}function _e(t,e,a){const n=Object.create(t);return n.item=e[a],n.i=a,n}function ve(t,e,a){const n=Object.create(t);return n.item=e[a],n.i=a,n}function ye(t){var e,n,r=[t.item,{i:t.i%8==0?0:t.i+.25*t.$tick}];let o={};for(var i=0;i<r.length;i+=1)o=a(o,r[i]);var s=new ie({props:o});return{c(){s.$$.fragment.c(),e=b()},m(t,a){it(s,t,a),_(t,e,a),n=!0},p(t,e){var a=t.arr_home_gems||t.$tick?rt(r,[t.arr_home_gems&&e.item,t.$tick&&{i:e.i%8==0?0:e.i+.25*e.$tick}]):{};s.$set(a)},i(t){n||(Z(s.$$.fragment,t),n=!0)},o(t){tt(s.$$.fragment,t),n=!1},d(t){st(s,t),t&&v(e)}}}function ke(t){var e,a=new St({props:{anchor:[50,70],bias:[50,100],position:t.gem_clutch?t.circle_clutch({i:t.i,scale:t.$scaling}):t.circle({i:t.i+.368*t.$tick,scale:t.$scaling}),area:[-150,25],scale:1+.1*Math.sin(t.i-.5*t.$tick),rotate:90+45*Math.abs(Math.sin(t.i-.05*t.$tick)),$$slots:{default:[ye]},$$scope:{ctx:t}}});return{c(){a.$$.fragment.c()},m(t,n){it(a,t,n),e=!0},p(t,e){var n={};(t.gem_clutch||t.circle_clutch||t.$scaling||t.circle||t.$tick)&&(n.position=e.gem_clutch?e.circle_clutch({i:e.i,scale:e.$scaling}):e.circle({i:e.i+.368*e.$tick,scale:e.$scaling})),t.$tick&&(n.scale=1+.1*Math.sin(e.i-.5*e.$tick)),t.$tick&&(n.rotate=90+45*Math.abs(Math.sin(e.i-.05*e.$tick))),(t.$$scope||t.arr_home_gems||t.$tick)&&(n.$$scope={changed:t,ctx:e}),a.$set(n)},i(t){e||(Z(a.$$.fragment,t),e=!0)},o(t){tt(a.$$.fragment,t),e=!1},d(t){st(a,t)}}}function we(t){var e,n,r=[t.item,{i:t.i}];let o={};for(var i=0;i<r.length;i+=1)o=a(o,r[i]);var s=new le({props:o});return{c(){s.$$.fragment.c(),e=b()},m(t,a){it(s,t,a),_(t,e,a),n=!0},p(t,e){var a=t.arr_home_hearts?rt(r,[e.item,{i:e.i}]):{};s.$set(a)},i(t){n||(Z(s.$$.fragment,t),n=!0)},o(t){tt(s.$$.fragment,t),n=!1},d(t){st(s,t),t&&v(e)}}}function be(t){var e,a=new St({props:{anchor:[50,70],bias:[50,50],zIndex:-20,position:t.heart_clutch?t.circle_heart_clutch({i:t.i,scale:t.$scaling}):t.circle_heart({i:10*t.i+.168*t.$tick,scale:t.$scaling}),scale:1+.1*Math.sin(t.i-.5*t.$tick),area:[-50,25],$$slots:{default:[we]},$$scope:{ctx:t}}});return{c(){a.$$.fragment.c()},m(t,n){it(a,t,n),e=!0},p(t,e){var n={};(t.heart_clutch||t.circle_heart_clutch||t.$scaling||t.circle_heart||t.$tick)&&(n.position=e.heart_clutch?e.circle_heart_clutch({i:e.i,scale:e.$scaling}):e.circle_heart({i:10*e.i+.168*e.$tick,scale:e.$scaling})),t.$tick&&(n.scale=1+.1*Math.sin(e.i-.5*e.$tick)),(t.$$scope||t.arr_home_hearts)&&(n.$$scope={changed:t,ctx:e}),a.$set(n)},i(t){e||(Z(a.$$.fragment,t),e=!0)},o(t){tt(a.$$.fragment,t),e=!1},d(t){st(a,t)}}}function xe(t){var e,n,r=[t.item,{i:t.i}];let o={};for(var i=0;i<r.length;i+=1)o=a(o,r[i]);var s=new me({props:o});return{c(){s.$$.fragment.c(),e=b()},m(t,a){it(s,t,a),_(t,e,a),n=!0},p(t,e){var a=t.$home_tokens?rt(r,[e.item,{i:e.i}]):{};s.$set(a)},i(t){n||(Z(s.$$.fragment,t),n=!0)},o(t){tt(s.$$.fragment,t),n=!1},d(t){st(s,t),t&&v(e)}}}function Me(t){var e,a=new St({props:{anchor:[50,70],bias:[50,50],zIndex:-1e3,area:[-30,-40],position:[0,25],scale:3+.1*Math.sin(t.i-.168*t.$tick),$$slots:{default:[xe]},$$scope:{ctx:t}}});return{c(){a.$$.fragment.c()},m(t,n){it(a,t,n),e=!0},p(t,e){var n={};t.$tick&&(n.scale=3+.1*Math.sin(e.i-.168*e.$tick)),(t.$$scope||t.$home_tokens)&&(n.$$scope={changed:t,ctx:e}),a.$set(n)},i(t){e||(Z(a.$$.fragment,t),e=!0)},o(t){tt(a.$$.fragment,t),e=!1},d(t){st(a,t)}}}function je(t){var e,n,r,i,s,c,l,d,h,u,g,f,m,$,w,x,E=new ae({props:{cards:Rt.state.home_hand,scale:Ee,position:[0,0],back:Rt.state.home_back,drag:!0,anchor:[50,90]}});E.$on("dragend",t.dragend_handler);var S=[t.deck,{anchor:[90,70]},{cards:Rt.state.home_deck},{position:[0,0]},{back:Rt.state.home_back}];let z={};for(var C=0;C<S.length;C+=1)z=a(z,S[C]);var I=new ae({props:z});I.$on("click",t.click_handler);var T=new ae({props:{cards:t.play_home,position:[0,0],anchor:[50,50],scale:"0.4",back:Rt.state.home_back}}),A=new ae({props:{cards:t.play_away,position:[0,0],anchor:[50,50],scale:"0.4",back:Rt.state.away_back}}),R=[t.discard,{cards:Rt.state.home_discard},{position:[0,0]},{anchor:[0,90]},{back:Rt.state.home_back}];let O={};for(C=0;C<R.length;C+=1)O=a(O,R[C]);var L=new ae({props:O}),N=new ae({props:{cards:Rt.state.away_hand,scale:Ee,anchor:[50,0],interact:!1,color:180,invert:!0,back:Rt.state.away_back}}),P=[t.deck,{cards:Rt.state.away_deck},{color:180},{anchor:[90,30]},{back:Rt.state.away_back}];let D={};for(C=0;C<P.length;C+=1)D=a(D,P[C]);var U=new ae({props:D}),W=[t.discard,{cards:Rt.state.away_discard},{anchor:[0,10]},{back:Rt.state.away_back}];let B={};for(C=0;C<W.length;C+=1)B=a(B,W[C]);var H=new ae({props:B}),F=t.arr_home_gems,K=[];for(C=0;C<F.length;C+=1)K[C]=ke(ve(t,F,C));const Y=t=>tt(K[t],1,1,()=>{K[t]=null});var q=t.arr_home_hearts,G=[];for(C=0;C<q.length;C+=1)G[C]=be(_e(t,q,C));const X=t=>tt(G[t],1,1,()=>{G[t]=null});var J=t.$home_tokens,at=[];for(C=0;C<J.length;C+=1)at[C]=Me(pe(t,J,C));const nt=t=>tt(at[t],1,1,()=>{at[t]=null});return{c(){e=k("div"),E.$$.fragment.c(),n=b(),I.$$.fragment.c(),r=b(),T.$$.fragment.c(),i=b(),A.$$.fragment.c(),s=b(),L.$$.fragment.c(),c=b(),N.$$.fragment.c(),l=b(),U.$$.fragment.c(),d=b(),H.$$.fragment.c(),h=b(),u=k("div");for(var a=0;a<K.length;a+=1)K[a].c();g=b(),f=k("div");for(a=0;a<G.length;a+=1)G[a].c();m=b();for(a=0;a<at.length;a+=1)at[a].c();j(e,"class","game svelte-1bvhcmr"),x=[M(u,"click",t.click_handler_1),M(f,"click",t.click_handler_2)]},m(t,a){_(t,e,a),it(E,e,null),p(e,n),it(I,e,null),p(e,r),it(T,e,null),p(e,i),it(A,e,null),p(e,s),it(L,e,null),p(e,c),it(N,e,null),p(e,l),it(U,e,null),p(e,d),it(H,e,null),p(e,h),p(e,u);for(var o=0;o<K.length;o+=1)K[o].m(u,null);p(e,g),p(e,f);for(o=0;o<G.length;o+=1)G[o].m(f,null);p(e,m);for(o=0;o<at.length;o+=1)at[o].m(e,null);w=!0},p(t,a){var n={};t.game&&(n.cards=Rt.state.home_hand),t.scale&&(n.scale=Ee),t.game&&(n.back=Rt.state.home_back),E.$set(n);var r=t.deck||t.game?rt(S,[t.deck&&a.deck,{anchor:[90,70]},t.game&&{cards:Rt.state.home_deck},{position:[0,0]},t.game&&{back:Rt.state.home_back}]):{};I.$set(r);var o={};t.play_home&&(o.cards=a.play_home),t.game&&(o.back=Rt.state.home_back),T.$set(o);var i={};t.play_away&&(i.cards=a.play_away),t.game&&(i.back=Rt.state.away_back),A.$set(i);var s=t.discard||t.game?rt(R,[t.discard&&a.discard,t.game&&{cards:Rt.state.home_discard},{position:[0,0]},{anchor:[0,90]},t.game&&{back:Rt.state.home_back}]):{};L.$set(s);var c={};t.game&&(c.cards=Rt.state.away_hand),t.scale&&(c.scale=Ee),t.game&&(c.back=Rt.state.away_back),N.$set(c);var l=t.deck||t.game?rt(P,[t.deck&&a.deck,t.game&&{cards:Rt.state.away_deck},{color:180},{anchor:[90,30]},t.game&&{back:Rt.state.away_back}]):{};U.$set(l);var d=t.discard||t.game?rt(W,[t.discard&&a.discard,t.game&&{cards:Rt.state.away_discard},{anchor:[0,10]},t.game&&{back:Rt.state.away_back}]):{};if(H.$set(d),t.gem_clutch||t.circle_clutch||t.$scaling||t.circle||t.$tick||t.arr_home_gems){F=a.arr_home_gems;for(var h=0;h<F.length;h+=1){const e=ve(a,F,h);K[h]?(K[h].p(t,e),Z(K[h],1)):(K[h]=ke(e),K[h].c(),Z(K[h],1),K[h].m(u,null))}for(Q(),h=F.length;h<K.length;h+=1)Y(h);V()}if(t.heart_clutch||t.circle_heart_clutch||t.$scaling||t.circle_heart||t.$tick||t.arr_home_hearts){q=a.arr_home_hearts;for(h=0;h<q.length;h+=1){const e=_e(a,q,h);G[h]?(G[h].p(t,e),Z(G[h],1)):(G[h]=be(e),G[h].c(),Z(G[h],1),G[h].m(f,null))}for(Q(),h=q.length;h<G.length;h+=1)X(h);V()}if(t.$tick||t.$home_tokens){J=a.$home_tokens;for(h=0;h<J.length;h+=1){const n=pe(a,J,h);at[h]?(at[h].p(t,n),Z(at[h],1)):(at[h]=Me(n),at[h].c(),Z(at[h],1),at[h].m(e,null))}for(Q(),h=J.length;h<at.length;h+=1)nt(h);V()}},i(t){if(!w){Z(E.$$.fragment,t),Z(I.$$.fragment,t),Z(T.$$.fragment,t),Z(A.$$.fragment,t),Z(L.$$.fragment,t),Z(N.$$.fragment,t),Z(U.$$.fragment,t),Z(H.$$.fragment,t);for(var e=0;e<F.length;e+=1)Z(K[e]);for(e=0;e<q.length;e+=1)Z(G[e]);for(e=0;e<J.length;e+=1)Z(at[e]);$&&$.end(1),w=!0}},o(t){tt(E.$$.fragment,t),tt(I.$$.fragment,t),tt(T.$$.fragment,t),tt(A.$$.fragment,t),tt(L.$$.fragment,t),tt(N.$$.fragment,t),tt(U.$$.fragment,t),tt(H.$$.fragment,t),K=K.filter(Boolean);for(let t=0;t<K.length;t+=1)tt(K[t]);G=G.filter(Boolean);for(let t=0;t<G.length;t+=1)tt(G[t]);at=at.filter(Boolean);for(let t=0;t<at.length;t+=1)tt(at[t]);$=et(e,gt,{delay:100,duration:1e3,x:0,y:1e3,opacity:0}),w=!1},d(t){t&&v(e),st(E),st(I),st(T),st(A),st(L),st(N),st(U),st(H),y(K,t),y(G,t),y(at,t),t&&$&&$.end(),o(x)}}}const Ee=.25;function Se(t,e,a){let n,r,o,i,s;c(t,bt,t=>{a("$scaling",o=t)}),c(t,Mt,t=>{a("$tick",i=t)});const{home_gems:l,home_hearts:d,home_tokens:h}=Rt.state;c(t,l,t=>{a("$home_gems",n=t)}),c(t,d,t=>{a("$home_hearts",r=t)}),c(t,h,t=>{a("$home_tokens",s=t)});const u={scale:Ee,spread:0,max:4,reverse:!0,interact:!1},g=$e({max:32,radius:75});let f=!1;const m=$e({max:9,radius:75}),$=$e({max:60,radius:20});let p=!1;const _=$e({max:6,radius:30,wobble:[5,5]}),v=wt([]),y=wt([]),k={scale:Ee,spread:5,spread_y:0,rotate:0,rotation:90,fade:!0,drag:!0,max:10};let w,b;return Rt.server_fake(),t.$$.update=((t={$home_gems:1,$home_hearts:1})=>{t.$home_gems&&a("arr_home_gems",w=Array.from(Array(9)).map((t,e)=>({empty:e<n}))),t.$home_hearts&&a("arr_home_hearts",b=Array.from(Array(6)).map((t,e)=>({empty:e<r})))}),{home_gems:l,home_hearts:d,home_tokens:h,deck:u,circle:g,gem_clutch:f,circle_clutch:m,circle_heart:$,heart_clutch:p,circle_heart_clutch:_,play_home:v,play_away:y,discard:k,arr_home_gems:w,arr_home_hearts:b,$scaling:o,$tick:i,$home_tokens:s,dragend_handler:function({detail:{id:t}}){Rt.do_server({task:"PLAY",data:{id:t}})},click_handler:function(){Rt.do_server({task:"DRAW"})},click_handler_1:function(){const t=f=!f;return a("gem_clutch",f),t},click_handler_2:function(){const t=p=!p;return a("heart_clutch",p),t}}}class ze extends dt{constructor(t){super(),lt(this,t,Se,je,s,[])}}function Ce(e){var a,n,r;return{c(){(a=k("div")).textContent="Still Ruff",j(a,"class","design svelte-1hbrshb")},m(t,e){_(t,a,e),r=!0},p:t,i(t){r||(n&&n.end(1),r=!0)},o(t){n=et(a,ut,{duration:100}),r=!1},d(t){t&&(v(a),n&&n.end())}}}function Ie(t){var e,a=new St({props:{bias:[50,50],anchor:[50,50],area:[-1e3,50],$$slots:{default:[Ce]},$$scope:{ctx:t}}});return{c(){a.$$.fragment.c()},m(t,n){it(a,t,n),e=!0},p(t,e){var n={};t.$$scope&&(n.$$scope={changed:t,ctx:e}),a.$set(n)},i(t){e||(Z(a.$$.fragment,t),e=!0)},o(t){tt(a.$$.fragment,t),e=!1},d(t){st(a,t)}}}class Te extends dt{constructor(t){super(),lt(this,t,null,Ie,s,[])}}function Ae(t){var e,a=new pt({});return a.$on("start",t.start),a.$on("design",t.design),{c(){a.$$.fragment.c()},m(t,n){it(a,t,n),e=!0},i(t){e||(Z(a.$$.fragment,t),e=!0)},o(t){tt(a.$$.fragment,t),e=!1},d(t){st(a,t)}}}function Re(t){var e,a=new Te({});return a.$on("end",t.end),{c(){a.$$.fragment.c()},m(t,n){it(a,t,n),e=!0},i(t){e||(Z(a.$$.fragment,t),e=!0)},o(t){tt(a.$$.fragment,t),e=!1},d(t){st(a,t)}}}function Oe(t){var e,a=new ze({});return a.$on("end",t.end),{c(){a.$$.fragment.c()},m(t,n){it(a,t,n),e=!0},i(t){e||(Z(a.$$.fragment,t),e=!0)},o(t){tt(a.$$.fragment,t),e=!1},d(t){st(a,t)}}}function Le(t){var e,a,n,r,o,i,s=[Oe,Re,Ae],c=[];function l(t){return t.playing?0:t.designing?1:2}e=l(t),a=c[e]=s[e](t);var d=new kt({props:{playing:t.playing,designing:t.designing}});d.$on("end",t.end);var h=new Ht({props:{random:!0}});return{c(){a.c(),n=b(),d.$$.fragment.c(),r=b(),o=k("div"),h.$$.fragment.c(),j(o,"class","background svelte-135avyh")},m(t,a){c[e].m(t,a),_(t,n,a),it(d,t,a),_(t,r,a),_(t,o,a),it(h,o,null),i=!0},p(t,r){var o=e;(e=l(r))!==o&&(Q(),tt(c[o],1,1,()=>{c[o]=null}),V(),(a=c[e])||(a=c[e]=s[e](r)).c(),Z(a,1),a.m(n.parentNode,n));var i={};t.playing&&(i.playing=r.playing),t.designing&&(i.designing=r.designing),d.$set(i)},i(t){i||(Z(a),Z(d.$$.fragment,t),Z(h.$$.fragment,t),i=!0)},o(t){tt(a),tt(d.$$.fragment,t),tt(h.$$.fragment,t),i=!1},d(t){c[e].d(t),t&&v(n),st(d,t),t&&(v(r),v(o)),st(h)}}}function Ne(t,e,a){let n="/play"===window.location.pathname,r="/design"===window.location.pathname;return{playing:n,designing:r,design:()=>{a("designing",r=!0),history.pushState({page:1},"","/design")},start:()=>{a("playing",n=!0),history.pushState({page:1},"","/play")},end:()=>{a("playing",n=!1),a("designing",r=!1),history.pushState({page:1},"","/")}}}return new class extends dt{constructor(t){super(),lt(this,t,Ne,Le,s,[])}}({target:document.body,props:{name:"stage"}})}();

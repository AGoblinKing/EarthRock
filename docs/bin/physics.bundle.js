!function(){"use strict";
/* @license twgl.js 4.14.1 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
	Available via the MIT license.
	see: http://github.com/greggman/twgl.js for details */
let t=Float32Array;var n=Object.freeze({__proto__:null,add:function(n,e,o){return(o=o||new t(3))[0]=n[0]+e[0],o[1]=n[1]+e[1],o[2]=n[2]+e[2],o},copy:function(n,e){return(e=e||new t(3))[0]=n[0],e[1]=n[1],e[2]=n[2],e},create:function(n,e,o){const i=new t(3);return n&&(i[0]=n),e&&(i[1]=e),o&&(i[2]=o),i},cross:function(n,e,o){o=o||new t(3);const i=n[2]*e[0]-n[0]*e[2],r=n[0]*e[1]-n[1]*e[0];return o[0]=n[1]*e[2]-n[2]*e[1],o[1]=i,o[2]=r,o},distance:function(t,n){const e=t[0]-n[0],o=t[1]-n[1],i=t[2]-n[2];return Math.sqrt(e*e+o*o+i*i)},distanceSq:function(t,n){const e=t[0]-n[0],o=t[1]-n[1],i=t[2]-n[2];return e*e+o*o+i*i},divide:function(n,e,o){return(o=o||new t(3))[0]=n[0]/e[0],o[1]=n[1]/e[1],o[2]=n[2]/e[2],o},divScalar:function(n,e,o){return(o=o||new t(3))[0]=n[0]/e,o[1]=n[1]/e,o[2]=n[2]/e,o},dot:function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},lerp:function(n,e,o,i){return(i=i||new t(3))[0]=n[0]+o*(e[0]-n[0]),i[1]=n[1]+o*(e[1]-n[1]),i[2]=n[2]+o*(e[2]-n[2]),i},lerpV:function(n,e,o,i){return(i=i||new t(3))[0]=n[0]+o[0]*(e[0]-n[0]),i[1]=n[1]+o[1]*(e[1]-n[1]),i[2]=n[2]+o[2]*(e[2]-n[2]),i},length:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])},lengthSq:function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},max:function(n,e,o){return(o=o||new t(3))[0]=Math.max(n[0],e[0]),o[1]=Math.max(n[1],e[1]),o[2]=Math.max(n[2],e[2]),o},min:function(n,e,o){return(o=o||new t(3))[0]=Math.min(n[0],e[0]),o[1]=Math.min(n[1],e[1]),o[2]=Math.min(n[2],e[2]),o},mulScalar:function(n,e,o){return(o=o||new t(3))[0]=n[0]*e,o[1]=n[1]*e,o[2]=n[2]*e,o},multiply:function(n,e,o){return(o=o||new t(3))[0]=n[0]*e[0],o[1]=n[1]*e[1],o[2]=n[2]*e[2],o},negate:function(n,e){return(e=e||new t(3))[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e},normalize:function(n,e){e=e||new t(3);const o=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],i=Math.sqrt(o);return i>1e-5?(e[0]=n[0]/i,e[1]=n[1]/i,e[2]=n[2]/i):(e[0]=0,e[1]=0,e[2]=0),e},setDefaultType:function(n){const e=t;return t=n,e},subtract:function(n,e,o){return(o=o||new t(3))[0]=n[0]-e[0],o[1]=n[1]-e[1],o[2]=n[2]-e[2],o}});var e=(t,e)=>{if(t.mass>0&&t["!force"]&&Array.isArray(t["!force"])&&n.add(t["!velocity"],t["!force"],t["!velocity"]),!1===Array.isArray(t["!velocity"])||0===t.mass||n.length(t["!velocity"])<.01)return;let o=.9;o=t.mass>=0?o*t.mass:o/Math.abs(t.mass),n.add(t.position,t["!velocity"],t.position),n.mulScalar(t["!velocity"],o,t["!velocity"]),t["!real"]&&(t=>n=>Object.entries(t).forEach(n))(e)(([e,o])=>{if(((t,n)=>{if(t.id===n.id||!n["!real"]||!t["!real"])return!1;const[e,o]=[t.scale/2*.9,n.scale/2*.9];return t.position[0]-e<=n.position[0]+o&&t.position[0]+e>=n.position[0]-o&&t.position[1]-e<=n.position[1]+o&&t.position[1]+e>=n.position[1]-o&&t.position[2]-e<=n.position[2]+o&&t.position[2]+e>=n.position[2]-o})(t,o)){t["!collide"]=o.id,o.mass>0&&n.add(o["!velocity"],n.mulScalar(t["!velocity"],.5),o["!velocity"]);const e=n.subtract(t.position,o.position);n.subtract(t.position,t["!velocity"],t.position),Math.abs(e[0])>Math.abs(e[1])?t["!velocity"][0]=-t["!velocity"][0]:t["!velocity"][1]=-t["!velocity"][1]}})};const o={solve(t){var n;postMessage({type:"solve",bodies:(n=t,t=>Object.fromEntries(Object.entries(n).reduce((n,[e,o])=>{const i=t([e,o]);return i&&n.push(i),n},[])))(([n,o])=>{o.position=o.position||[0,0,0],o["!velocity"]=o["!velocity"]||[0,0,0],o.scale=o.scale||1,o.mass="number"==typeof o.mass?o.mass:1,e(o,t);const i={position:o.position,"!velocity":o["!velocity"]};return o["!collide"]&&(i["!collide"]=o["!collide"]),[n,i]})})}};onmessage=({data:{type:t,data:n=!1}})=>{o[t]&&o[t](n)}}();
